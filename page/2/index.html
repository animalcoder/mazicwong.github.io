<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>mazicwong</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="blog">
<meta property="og:type" content="website">
<meta property="og:title" content="mazicwong">
<meta property="og:url" content="mazicwong.github.io/page/2/index.html">
<meta property="og:site_name" content="mazicwong">
<meta property="og:description" content="blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mazicwong">
<meta name="twitter:description" content="blog">
  
    <link rel="alternate" href="/atom.xml" title="mazicwong" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">mazicwong</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">记录日常</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="mazicwong.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-KMP" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/12/KMP/" class="article-date">
  <time datetime="2017-08-11T18:14:06.000Z" itemprop="datePublished">2017-08-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/12/KMP/">KMP</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="mazicwong.github.io/2017/08/12/KMP/" data-id="cj6p4z93j0005nesc4qolollw" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-尺取法" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/11/尺取法/" class="article-date">
  <time datetime="2017-08-10T17:54:47.000Z" itemprop="datePublished">2017-08-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/11/尺取法/">尺取法</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>挑战程序竞赛 P146</p>
<p>挑战书上面的话说，尺取法通常是对数组保存一对下标，即所选取的区间的左右端点，然后根据实际情况不断地推进区间左右端点以得出答案。  </p>
<p>尺取法：像尺子一样取一段,设置左右端点,不断右移右端点和左端点,直到找到最优解<br>之所以需要掌握这个技巧，是因为尺取法比直接暴力枚举区间效率高很多，尤其是数据量大的时候，所以尺取法是一种高效的枚举区间的方法  </p>
<p>应用：(优化枚举区间效率)</p>
<ol>
<li>求有一定限制的区间个数或最短的区间等等  </li>
<li>最短的覆盖所有点的子序列 poj3320</li>
</ol>
<p>模板如下:四步<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">void solve()</div><div class="line">&#123;</div><div class="line">    int ans = INF;</div><div class="line">    int s=0,t=0,sum=0;//左右端点和前缀和</div><div class="line">    while(1)</div><div class="line">    &#123;</div><div class="line">        while(t&lt;n &amp;&amp; sum&lt;S)</div><div class="line">            sum += a[t++];//右端点右移</div><div class="line">        if (sum&lt;S) break;</div><div class="line">        ans = min(ans,t-s);</div><div class="line">        sum -= a[s++];//左端点右移</div><div class="line">    &#125;</div><div class="line">    if (ans == INF) ans=0;</div><div class="line">    printf(&quot;%d\n&quot;,ans);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="poj3061"><a href="#poj3061" class="headerlink" title="poj3061"></a>poj3061</h3><p>题意：给定一个序列，找出最短的子序列长度，使得其和大于或等于S。<br>思路：当区间和小于S时右端点向右移动，和大于等于S时，左端点向右移动以进一步找到最短的区间，如果右端点移动到区间末尾其和还不大于等于S.结束枚举</p>
<h3 id="poj3320"><a href="#poj3320" class="headerlink" title="poj3320"></a>poj3320</h3><p>题意:一本书有n页，每一页都一个知识点，求去最少的连续页数覆盖所有的知识点。<br>思路:一样,右端点移动到满足的位置,此时,如果该区间的子区间满足条件,左端点移动,使得子区间更短(用map和set方便处理数据)</p>
<h3 id="hdu6103"><a href="#hdu6103" class="headerlink" title="hdu6103"></a>hdu6103</h3><p><a href="http://blog.csdn.net/archger/article/details/77073334" target="_blank" rel="external">参考</a><br>题意:<br>给出字符串s，寻找其两个长度相同且不重叠的子串，使得两个字符串<code>每位的ascii差值(一个从前往后,一个从后往前)</code>之和不大于m，且字符串长度最长。<br>思路:<br>这是第六次多校的题目,直接暴力过不掉,复杂度O(n^2),刚好处理<code>区间最优子序列</code>可以用尺取法,节省枚举所有区间的时间;<br>因为字符串的长度为5000，所以可以枚举两个子串的对称轴，预处理出一个<code>num[]</code>数组,表示对称轴左右元素的ascii差值;然后对其区间进行尺取法，这样只需要o(n^2)的复杂度即可。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="mazicwong.github.io/2017/08/11/尺取法/" data-id="cj6p4z94m0010nesc7mwyg5ce" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/区间/">区间</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/尺取法/">尺取法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/常用技巧/">常用技巧</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-字符串" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/09/字符串/" class="article-date">
  <time datetime="2017-08-09T13:23:44.000Z" itemprop="datePublished">2017-08-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/09/字符串/">字符串</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li><a href="#1">1.KMP</a></li>
<li><a href="#2">2.扩展KMP</a></li>
<li><a href="#3">3.manacher最长回文子串</a></li>
<li><a href="#4">4.AC自动机</a></li>
<li><a href="#5">5.后缀数组</a></li>
<li><a href="#6">6.后缀自动机</a></li>
<li><a href="#7">7.字符串HASH</a></li>
</ul>
<h1 id="1"> KMP </h1>


<h1 id="2"> 扩展KMP </h1>



<h1 id="3"> manacher最长回文子串 </h1>

      
    </div>
    <footer class="article-footer">
      <a data-url="mazicwong.github.io/2017/08/09/字符串/" data-id="cj6p4z94i000wnesc5xnsd1i5" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-图的表示法" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/04/图的表示法/" class="article-date">
  <time datetime="2017-08-04T12:56:02.000Z" itemprop="datePublished">2017-08-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/04/图的表示法/">图的表示法</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="数组表示"><a href="#数组表示" class="headerlink" title="数组表示"></a>数组表示</h2><hr>
<p>//无权图就删掉下面跟w有关的<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> to;</div><div class="line">    <span class="keyword">int</span> next;</div><div class="line">    <span class="keyword">int</span> w;</div><div class="line">&#125;e[maxn&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> head[maxn];</div><div class="line"><span class="keyword">int</span> tot=<span class="number">0</span>;</div></pre></td></tr></table></figure></p>
<p>//操作<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(<span class="number">-1</span>));</div><div class="line">    tot=<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span></span></div><div class="line">&#123;</div><div class="line">    e[tot].to=v;</div><div class="line">    e[tot].w=w;</div><div class="line">    e[tot].next=head[u];</div><div class="line">    head[u]=tot++;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>//遍历<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k=head[u];k!=<span class="number">-1</span>;k=e[k].next)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> v=e[k].to;</div><div class="line">    <span class="keyword">int</span> w=e[k].w;</div><div class="line">    <span class="comment">//do something...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="vector表示"><a href="#vector表示" class="headerlink" title="vector表示"></a>vector表示</h2><hr>
<h4 id="无向无权图"><a href="#无向无权图" class="headerlink" title="//无向无权图"></a>//无向无权图</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; V[maxn];</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;i++)</div><div class="line">&#123;</div><div class="line">    <span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v;</div><div class="line">    V[u].push_back(v);</div><div class="line">    V[v].push_back(u);</div><div class="line">&#125;</div><div class="line"><span class="comment">//遍历</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;V[i].size();i++)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; V[i][j];</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h4 id="有向无权图"><a href="#有向无权图" class="headerlink" title="//有向无权图"></a>//有向无权图</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; V[maxn];</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;i++)</div><div class="line">&#123;</div><div class="line">    <span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v;</div><div class="line">    V[u].push_back(v);</div><div class="line">&#125;</div><div class="line"><span class="comment">//遍历</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;V[i].size();j++)</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; V[i][j];</div></pre></td></tr></table></figure>
<h4 id="有向有权图"><a href="#有向有权图" class="headerlink" title="//有向有权图"></a>//有向有权图</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> t;</div><div class="line">    <span class="keyword">int</span> val;</div><div class="line">&#125;;</div><div class="line"><span class="built_in">vector</span>&lt;node&gt; V[maxn];</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;i++)</div><div class="line">&#123;</div><div class="line">    node aa;</div><div class="line">    <span class="built_in">cin</span> &gt;&gt; u &gt;&gt; aa.v &gt;&gt; aa.val;</div><div class="line">    V[u].push_back(aa);</div><div class="line">&#125;</div><div class="line"><span class="comment">//遍历</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;V[i].size();j++)</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; V[i][j].to &lt;&lt; <span class="string">" "</span> &lt;&lt; V[i][j].val &lt;&lt; <span class="built_in">endl</span>;</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="mazicwong.github.io/2017/08/04/图的表示法/" data-id="cj6p4z94f000tnesc2p4xluco" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/邻接表/">邻接表</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-LCA+RMQ" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/01/LCA+RMQ/" class="article-date">
  <time datetime="2017-08-01T14:44:00.000Z" itemprop="datePublished">2017-08-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/01/LCA+RMQ/">LCA+RMQ</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>lca+rmq<br>常见题型:</p>
<ol>
<li>给一个”无环”的图,求任意两点的距离(lca)<br>区别于最短路算法: 最短路是用在图中的,可以有环存在<br>PS:如果是无环的森林,可以通过引入并查集来解决,如hdu2874</li>
</ol>
<h2 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span>+<span class="number">5</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span>  <span class="comment">//(u,v)边</span></div><div class="line">    <span class="keyword">int</span> to;   <span class="comment">//这条边指向的节点(v点)</span></div><div class="line">    <span class="keyword">int</span> next; <span class="comment">//这条边的上一条边(同样邻接到u点的边)</span></div><div class="line">    <span class="comment">//有权树 int cost;</span></div><div class="line">&#125;e[maxn&lt;&lt;<span class="number">1</span>];  <span class="comment">//e[0..2n-3] 树e=n-1</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> head[maxn]; <span class="comment">//存每个点遍历到的最后一个儿子</span></div><div class="line"><span class="keyword">int</span> tot=<span class="number">0</span>;      <span class="comment">//存边</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">    e[tot].to=v;</div><div class="line">    <span class="comment">//有权树(传入val) e[tot].cost=val;</span></div><div class="line">    e[tot].next=head[u];<span class="comment">//next存上一次访问u点的边,用来回溯时找到u点所有边</span></div><div class="line">    head[u]=tot++;<span class="comment">//head[u]存每次访问的边,最终是指向一个点的最后一条边</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//que[]:欧拉序列,即dfs遍历的顺序</span></div><div class="line"><span class="keyword">int</span> que[maxn&lt;&lt;<span class="number">1</span>];<span class="comment">//第i次dfs访问节点的编号[1..2n-1]  (vs[i])</span></div><div class="line"><span class="keyword">int</span> dep[maxn&lt;&lt;<span class="number">1</span>];<span class="comment">//第i次dfs访问节点的深度  </span></div><div class="line"><span class="keyword">int</span> fir[maxn];<span class="comment">//在que数组中i节点首次出现的下标 (id[i])</span></div><div class="line"><span class="keyword">int</span> vis[maxn&lt;&lt;<span class="number">1</span>];<span class="comment">//dfs中是否访问过节点</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> p[maxn&lt;&lt;<span class="number">1</span>];<span class="comment">//每个点的父节点</span></div><div class="line"><span class="keyword">int</span> st[maxn&lt;&lt;<span class="number">1</span>][<span class="number">20</span>];<span class="comment">//rmq用来存的,st[i][j]从i开始的2^j个数</span></div><div class="line"><span class="keyword">int</span> cnt=<span class="number">0</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> d)</span><span class="comment">//传入点跟深度</span></span></div><div class="line">&#123;<span class="comment">//递归得到que[1..2n-1],fir[1..n],dep[1..2n-1]</span></div><div class="line">    vis[u]=<span class="number">1</span>;</div><div class="line">    que[++cnt]=u;fir[u]=cnt;dep[cnt]=d;<span class="comment">//dep[cnt]=d是que[]对应深度;dep[u]=d是直接u点深度,用depth()代替(4小时的血与泪..)</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k=head[u];k!=<span class="number">-1</span>;k=e[k].next)<span class="comment">//head[u],u指向的最后一条边</span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> v=e[k].to;</div><div class="line">        <span class="keyword">if</span> (!vis[v])</div><div class="line">        &#123;</div><div class="line">            p[v]=u;</div><div class="line">            dfs(v,d+<span class="number">1</span>);</div><div class="line">            <span class="comment">//有权树 dfs(v,d+e[k].cost);</span></div><div class="line">            que[++cnt]=u;dep[cnt]=d;<span class="comment">//访问完一个子树,自己要再次入队,但是fir[]不用更新</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">ST</span><span class="params">(<span class="keyword">int</span> n)</span></span></div><div class="line">&#123;<span class="comment">//ST函数,预处理st[i,j],从i开始2^j个数的最小值</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">        st[i][<span class="number">0</span>]=i;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;(<span class="number">1</span>&lt;&lt;j)&lt;=n;j++)</div><div class="line">	&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i+(<span class="number">1</span>&lt;&lt;j)<span class="number">-1</span>&lt;=n;i++)</div><div class="line">		&#123;</div><div class="line">            <span class="keyword">int</span> a=st[i][j<span class="number">-1</span>],b=st[i+(<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>))][j<span class="number">-1</span>];</div><div class="line">            st[i][j]=dep[a]&lt;dep[b]?a:b;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">RMQ</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></div><div class="line">&#123;<span class="comment">//传入两个点在que[]中首次出现位置,然后返回最小值在que[]中位置</span></div><div class="line"><span class="comment">//RMQ函数,计算[l,r]中dep[]最小的</span></div><div class="line">    <span class="keyword">int</span> k=<span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>((<span class="number">1</span>&lt;&lt;(k+<span class="number">1</span>))&lt;=r-l+<span class="number">1</span>)</div><div class="line">        k++;</div><div class="line">    <span class="keyword">int</span> a=st[l][k],b=st[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k];</div><div class="line">    <span class="keyword">return</span> dep[a]&lt;dep[b]?a:b;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span></div><div class="line">&#123;<span class="comment">//LCA(T,u,v) = RMQ(dep,fir[u],fir[v]) (lca转化为rmq)</span></div><div class="line">    <span class="keyword">int</span> x=fir[u],y=fir[v];</div><div class="line">    <span class="keyword">if</span>(x&gt;y) swap(x,y);</div><div class="line">    <span class="keyword">int</span> ans=RMQ(x,y);</div><div class="line">    <span class="keyword">return</span> que[ans];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/********************************************/</span></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">path</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> u,v;</div><div class="line">	<span class="keyword">int</span> lca;</div><div class="line">&#125;pa[maxn];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(path x,path y)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">return</span> dep[fir[x.lca]]&gt;dep[fir[y.lca]];</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> used[maxn];</div><div class="line"><span class="comment">/********************************************/</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    tot=<span class="number">0</span>;</div><div class="line">    cnt=<span class="number">0</span>;</div><div class="line">    p[<span class="number">1</span>]=<span class="number">0</span>;</div><div class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</div><div class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</div><div class="line">    <span class="comment">//memset(used,0,sizeof(used));</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">depth</span><span class="params">(<span class="keyword">int</span> u)</span></span></div><div class="line">&#123;<span class="comment">//从叶子往上的深度,方便计算</span></div><div class="line">    <span class="keyword">return</span> dep[fir[u]];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> n,q; <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;q;</div><div class="line">    init();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</div><div class="line">    &#123;</div><div class="line">		<span class="keyword">int</span> u; <span class="built_in">cin</span>&gt;&gt;u;</div><div class="line">        add(i,u);</div><div class="line">        add(u,i);</div><div class="line">    &#125;</div><div class="line">    dfs(<span class="number">1</span>,<span class="number">1</span>);</div><div class="line">    ST(<span class="number">2</span>*n<span class="number">-1</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="cf823D"><a href="#cf823D" class="headerlink" title="cf823D"></a>cf823D</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*************************************************************************</span></div><div class="line">	&gt; File Name: 832D.cpp</div><div class="line">	&gt; Author: mazicwong</div><div class="line">	&gt; Mail: mazicwong@gmail.com</div><div class="line">	&gt; Created Time: 2017年07月30日 星期日 22时19分46秒</div><div class="line"> ************************************************************************/</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span>+<span class="number">5</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> to,next;</div><div class="line">&#125;e[maxn&lt;&lt;<span class="number">1</span>];</div><div class="line"></div><div class="line"><span class="keyword">int</span> head[maxn];</div><div class="line"><span class="keyword">int</span> tot=<span class="number">0</span>;<span class="comment">//点数</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">    e[tot].to=v;</div><div class="line">    e[tot].next=head[u];</div><div class="line">    head[u]=tot++;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//que[]:欧拉序列,即dfs遍历的顺序</span></div><div class="line"><span class="keyword">int</span> que[maxn&lt;&lt;<span class="number">1</span>];<span class="comment">//第i次dfs访问节点的编号[1..2n-1]  (vs[i])</span></div><div class="line"><span class="keyword">int</span> dep[maxn&lt;&lt;<span class="number">1</span>];<span class="comment">//第i次dfs访问节点的深度  </span></div><div class="line"><span class="keyword">int</span> fir[maxn];<span class="comment">//在que数组中i节点首次出现的下标 (id[i])</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> p[maxn&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> st[maxn&lt;&lt;<span class="number">1</span>][<span class="number">20</span>];<span class="comment">//rmq用来存的,st[i][j]从i开始的2^j个数</span></div><div class="line"><span class="keyword">int</span> vis[maxn&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> cnt=<span class="number">0</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> d)</span></span></div><div class="line">&#123;</div><div class="line">    vis[u]=<span class="number">1</span>;</div><div class="line">    que[++cnt]=u;fir[u]=cnt;dep[cnt]=d;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k=head[u];k!=<span class="number">-1</span>;k=e[k].next)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> v=e[k].to;</div><div class="line">        <span class="keyword">if</span> (!vis[v])</div><div class="line">        &#123;</div><div class="line">            p[v]=u;</div><div class="line">            dfs(v,d+<span class="number">1</span>);</div><div class="line">            que[++cnt]=u;dep[cnt]=d;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">ST</span><span class="params">(<span class="keyword">int</span> n)</span></span></div><div class="line">&#123;<span class="comment">//ST函数,预处理st[i,j],从i开始2^j个数的最小值</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">        st[i][<span class="number">0</span>]=i;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;(<span class="number">1</span>&lt;&lt;j)&lt;=n;j++)</div><div class="line">	&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i+(<span class="number">1</span>&lt;&lt;j)<span class="number">-1</span>&lt;=n;i++)</div><div class="line">		&#123;</div><div class="line">            <span class="keyword">int</span> a=st[i][j<span class="number">-1</span>],b=st[i+(<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>))][j<span class="number">-1</span>];</div><div class="line">            st[i][j]=dep[a]&lt;dep[b]?a:b;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">RMQ</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></div><div class="line">&#123;<span class="comment">//传入两个点在que[]中首次出现位置,然后返回最小值在que[]中位置</span></div><div class="line"><span class="comment">//RMQ函数,计算[l,r]中dep[]最小的</span></div><div class="line">    <span class="keyword">int</span> k=<span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>((<span class="number">1</span>&lt;&lt;(k+<span class="number">1</span>))&lt;=r-l+<span class="number">1</span>)</div><div class="line">	&#123;</div><div class="line">        k++;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> a=st[l][k],b=st[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k];</div><div class="line">    <span class="keyword">return</span> dep[a]&lt;dep[b]?a:b;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span></div><div class="line">&#123;<span class="comment">//直接找两者中最近祖先</span></div><div class="line">    <span class="keyword">int</span> x=fir[u],y=fir[v];</div><div class="line">    <span class="keyword">if</span>(x&gt;y) swap(x,y);</div><div class="line">    <span class="keyword">int</span> ans=RMQ(x,y);</div><div class="line">    <span class="keyword">return</span> que[ans];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/********************************/</span></div><div class="line"><span class="comment">/*struct path&#123;</span></div><div class="line">	int u,v;</div><div class="line">	int lca;</div><div class="line">&#125;pa[maxn];</div><div class="line"></div><div class="line">int cmp(path x,path y)</div><div class="line">&#123;</div><div class="line">    return dep[fir[x.lca]]&gt;dep[fir[y.lca]];</div><div class="line">&#125;</div><div class="line">int used[maxn];*/</div><div class="line"><span class="comment">/********************************************/</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    tot=<span class="number">0</span>;</div><div class="line">    cnt=<span class="number">0</span>;</div><div class="line">    p[<span class="number">1</span>]=<span class="number">0</span>;</div><div class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</div><div class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</div><div class="line">    <span class="comment">//memset(used,0,sizeof(used));</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">depth</span><span class="params">(<span class="keyword">int</span> u)</span></span></div><div class="line">&#123;<span class="comment">//从叶子往上的深度(负数),方便计算</span></div><div class="line">    <span class="keyword">return</span> -dep[fir[u]];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> L[<span class="number">3</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">    <span class="keyword">int</span> n,q;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;q);</div><div class="line">    init();</div><div class="line">    <span class="keyword">int</span> u;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;u);</div><div class="line">        add(i,u);</div><div class="line">        add(u,i);</div><div class="line">    &#125;</div><div class="line">    dfs(<span class="number">1</span>,<span class="number">1</span>);</div><div class="line">    ST(<span class="number">2</span>*n<span class="number">-1</span>);</div><div class="line"></div><div class="line">    <span class="keyword">int</span> a,b,c;</div><div class="line">    <span class="keyword">while</span>(q--)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> ans=<span class="number">0</span>;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;c);</div><div class="line">        L[<span class="number">0</span>]=lca(a,b);</div><div class="line">        L[<span class="number">1</span>]=lca(a,c);</div><div class="line">        L[<span class="number">2</span>]=lca(b,c);</div><div class="line">        <span class="keyword">if</span> (L[<span class="number">0</span>]==L[<span class="number">1</span>] &amp;&amp; L[<span class="number">0</span>]==L[<span class="number">2</span>])</div><div class="line">        &#123;<span class="comment">//三个lca都一样</span></div><div class="line">            ans=max(ans,depth(L[<span class="number">0</span>])-depth(a));</div><div class="line">            ans=max(ans,depth(L[<span class="number">0</span>])-depth(b));</div><div class="line">            ans=max(ans,depth(L[<span class="number">0</span>])-depth(c));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//把L[2]换成非最上面的lca,L[0]变成最上面的lca</span></div><div class="line">            <span class="keyword">if</span> (L[<span class="number">1</span>]==L[<span class="number">2</span>])<span class="comment">//ac,bc</span></div><div class="line">            &#123;</div><div class="line">                swap(a,c);</div><div class="line">                swap(L[<span class="number">0</span>],L[<span class="number">2</span>]);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (L[<span class="number">0</span>]==L[<span class="number">2</span>])<span class="comment">//ab,bc</span></div><div class="line">            &#123;</div><div class="line">                swap(a,b);</div><div class="line">                swap(L[<span class="number">1</span>],L[<span class="number">2</span>]);</div><div class="line">            &#125;</div><div class="line">            ans = max(ans,<span class="number">2</span>*depth(L[<span class="number">0</span>]) - depth(a) - depth(L[<span class="number">2</span>]));</div><div class="line"></div><div class="line">            <span class="keyword">if</span>(L[<span class="number">2</span>]==b)</div><div class="line">            &#123;</div><div class="line">                ans=max(ans,depth(b)-depth(c));  </div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(L[<span class="number">2</span>]==c)</div><div class="line">            &#123;</div><div class="line">                ans=max(ans,depth(c)-depth(b));  </div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span>  </div><div class="line">                ans=max(ans,max(depth(L[<span class="number">2</span>])-depth(b),depth(L[<span class="number">2</span>])-depth(c)));  </div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans+<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="hdu2586-lca-rmq-板题"><a href="#hdu2586-lca-rmq-板题" class="headerlink" title="hdu2586 lca+rmq 板题"></a>hdu2586 lca+rmq 板题</h2><h3 id="题意"><a href="#题意" class="headerlink" title="题意:"></a>题意:</h3><blockquote>
<p>给一颗无根树(有权),q个询问,每次问两个节点间的距离</p>
</blockquote>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路:"></a>思路:</h3><blockquote>
<p>因为是树,所以是单边的,不用最短路算法(图)<br>这题每条边有权值,只要在存边的时候加多一个cost就可以了,然后dfs的时候小改下,dsf(v,d+1)变成dfs(v,d+e[k].cost,这样最后的结果就是用的边权了  </p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*************************************************************************</span></div><div class="line">	&gt; File Name: hdu2586.cpp</div><div class="line">	&gt; Author: mazicwong</div><div class="line">	&gt; Mail: mazicwong@gmail.com</div><div class="line">	&gt; Created Time: 2017年08月04日 星期五 20时33分45秒</div><div class="line"> ************************************************************************/</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="comment">/*</span></div><div class="line"> * 给一颗无根树,q个询问,每次问两个节点间的距离</div><div class="line"> * 因为是树,所以是单边的,不用最短路算法(图)</div><div class="line"> */</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">40000</span>+<span class="number">5</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> to;</div><div class="line">    <span class="keyword">int</span> next;</div><div class="line">    <span class="keyword">int</span> cost;</div><div class="line">&#125;e[maxn&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> head[maxn];</div><div class="line"><span class="keyword">int</span> tot=<span class="number">0</span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span></span></div><div class="line">&#123;</div><div class="line">    e[tot].to=v;</div><div class="line">    e[tot].cost=w;</div><div class="line">    e[tot].next=head[u];</div><div class="line">    head[u]=tot++;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> que[maxn&lt;&lt;<span class="number">1</span>];<span class="comment">//第i次dfs访问节点的编号[1..2n-1]  (vs[i])</span></div><div class="line"><span class="keyword">int</span> dep[maxn&lt;&lt;<span class="number">1</span>];<span class="comment">//第i次dfs访问节点的深度  </span></div><div class="line"><span class="keyword">int</span> fir[maxn];<span class="comment">//在que数组中i节点首次出现的下标 (id[i])</span></div><div class="line"><span class="keyword">int</span> vis[maxn&lt;&lt;<span class="number">1</span>];<span class="comment">//dfs中是否访问过节点</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> p[maxn&lt;&lt;<span class="number">1</span>];<span class="comment">//每个点的父节点</span></div><div class="line"><span class="keyword">int</span> st[maxn&lt;&lt;<span class="number">1</span>][<span class="number">20</span>];<span class="comment">//rmq用来存的,st[i][j]从i开始的2^j个数</span></div><div class="line"><span class="keyword">int</span> cnt=<span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> height[maxn];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> d)</span><span class="comment">//传入点跟深度</span></span></div><div class="line">&#123;</div><div class="line">    vis[u]=<span class="number">1</span>;</div><div class="line">    que[++cnt]=u;fir[u]=cnt;dep[cnt]=d;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k=head[u];k!=<span class="number">-1</span>;k=e[k].next)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> v=e[k].to;</div><div class="line">        <span class="keyword">if</span> (!vis[v])</div><div class="line">        &#123;</div><div class="line">            p[v]=u;</div><div class="line">            dfs(v,d+e[k].cost);<span class="comment">//小改</span></div><div class="line">            que[++cnt]=u;dep[cnt]=d;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">ST</span><span class="params">(<span class="keyword">int</span> n)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">        st[i][<span class="number">0</span>]=i;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;(<span class="number">1</span>&lt;&lt;j)&lt;=n;j++)</div><div class="line">	&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i+(<span class="number">1</span>&lt;&lt;j)<span class="number">-1</span>&lt;=n;i++)</div><div class="line">		&#123;</div><div class="line">            <span class="keyword">int</span> a=st[i][j<span class="number">-1</span>],b=st[i+(<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>))][j<span class="number">-1</span>];</div><div class="line">            st[i][j]=dep[a]&lt;dep[b]?a:b;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">RMQ</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> k=<span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>((<span class="number">1</span>&lt;&lt;(k+<span class="number">1</span>))&lt;=r-l+<span class="number">1</span>)</div><div class="line">        k++;</div><div class="line">    <span class="keyword">int</span> a=st[l][k],b=st[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k];</div><div class="line">    <span class="keyword">return</span> dep[a]&lt;dep[b]?a:b;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> x=fir[u],y=fir[v];</div><div class="line">    <span class="keyword">if</span>(x&gt;y) swap(x,y);</div><div class="line">    <span class="keyword">int</span> ans=RMQ(x,y);</div><div class="line">    <span class="keyword">return</span> que[ans];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    tot=<span class="number">0</span>;</div><div class="line">    cnt=<span class="number">0</span>;</div><div class="line">    p[<span class="number">1</span>]=<span class="number">0</span>;</div><div class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</div><div class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">depth</span><span class="params">(<span class="keyword">int</span> u)</span></span></div><div class="line">&#123;<span class="comment">//从叶子往上的深度,方便计算</span></div><div class="line">    <span class="keyword">return</span> dep[fir[u]];</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">    <span class="keyword">int</span> t;</div><div class="line">    <span class="built_in">cin</span> &gt;&gt; t;</div><div class="line">    <span class="keyword">while</span>(t--)</div><div class="line">    &#123;</div><div class="line">        init();</div><div class="line">        <span class="keyword">int</span> n,q;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;q);</div><div class="line">        <span class="keyword">int</span> a,b,val;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n<span class="number">-1</span>;i++)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;val);</div><div class="line">            add(a,b,val);</div><div class="line">            add(b,a,val);</div><div class="line">        &#125;</div><div class="line">        dfs(<span class="number">1</span>,<span class="number">1</span>);</div><div class="line">        ST(<span class="number">2</span>*n<span class="number">-1</span>);</div><div class="line">        <span class="keyword">int</span> u,v;</div><div class="line">        <span class="keyword">while</span>(q--)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;u,&amp;v);</div><div class="line">            <span class="keyword">int</span> tmp=lca(u,v);</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,depth(u)+depth(v)<span class="number">-2</span>*depth(tmp));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="hdu2874"><a href="#hdu2874" class="headerlink" title="hdu2874"></a>hdu2874</h2><h3 id="题意-1"><a href="#题意-1" class="headerlink" title="题意:"></a>题意:</h3><blockquote>
<p>n点,m带权边,给q组询问(i,j),问i,j之间是否存在路,存在则输出距离</p>
</blockquote>
<h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路:"></a>思路:</h3><blockquote>
<p>注意点:这里m!=n-1,森林用并查集来做,先用并查集判断是否在一棵树上,在就求LCA,输出<code>depth[u]+depth[v]-2*depth[lca(u,v)]</code><br>这里不能dfs(1,1)了,要对所有点dfs一次,因为不止一棵树<br>复习一下并查集<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/****************union_find*********************/</span></div><div class="line"><span class="keyword">int</span> fa[maxn&lt;&lt;<span class="number">1</span>];<span class="comment">//并查集所用,记录前驱节点</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init_fa</span><span class="params">(<span class="keyword">int</span> n)</span> </span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">    ┊   fa[i]=i;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span> </span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (x != fa[x]) fa[x]=find(fa[x]);</div><div class="line">    <span class="keyword">return</span> fa[x]; </div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">join</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> x=find(i);</div><div class="line">    <span class="keyword">int</span> y=find(j); </div><div class="line">    <span class="keyword">if</span> (x!=y) fa[y]=x; </div><div class="line">&#125;</div><div class="line"><span class="comment">//操作</span></div><div class="line">init_fa();</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;i++) join(u,v);</div><div class="line"><span class="comment">/****************union_find*********************/</span></div></pre></td></tr></table></figure></p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="mazicwong.github.io/2017/08/01/LCA+RMQ/" data-id="cj6p4z93s000cnesc6sqrxc1e" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LCA/">LCA</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RMQ/">RMQ</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-cf427" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/01/cf427/" class="article-date">
  <time datetime="2017-08-01T11:54:23.000Z" itemprop="datePublished">2017-08-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/01/cf427/">cf427</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="codeforces-Round-427-div2"><a href="#codeforces-Round-427-div2" class="headerlink" title="codeforces Round #427 div2"></a>codeforces Round #427 div2</h1><h2 id="835A"><a href="#835A" class="headerlink" title="835A"></a><a href="http://codeforces.com/problemset/problem/835/A" target="_blank" rel="external">835A</a></h2><p>题意:</p>
<blockquote>
<p>简单公式</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*************************************************************************</span></div><div class="line">	&gt; File Name: 1.cpp</div><div class="line">	&gt; Author: mazicwong</div><div class="line">	&gt; Mail: mazicwong@gmail.com</div><div class="line">	&gt; Created Time: 2017年07月31日 星期一 22时31分58秒</div><div class="line"> ************************************************************************/</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">    <span class="keyword">int</span> s,v1,v2,t1,t2;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d%d"</span>,&amp;s,&amp;v1,&amp;v2,&amp;t1,&amp;t2);</div><div class="line">    <span class="keyword">int</span> a=s*v1+<span class="number">2</span>*t1;</div><div class="line">    <span class="keyword">int</span> b=s*v2+<span class="number">2</span>*t2;</div><div class="line">    <span class="keyword">if</span> (a&lt;b)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"First"</span>);</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (a&gt;b)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Second"</span>);</div><div class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"Friendship"</span>);   </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="835B-贪心"><a href="#835B-贪心" class="headerlink" title="835B 贪心"></a><a href="http://codeforces.com/problemset/problem/835/B" target="_blank" rel="external">835B 贪心</a></h2><p>题意:</p>
<blockquote>
<p>给一个k(1 ≤ k ≤ 1e9)和n(1 ≤ n &lt; 1e100000),<br>要另n每一位相加的和大于等于k,问至少需要改动n的几个位</p>
</blockquote>
<p>思路:</p>
<blockquote>
<p>开map存下n中0~9出现的次数,然后从0开始转成9贪心出最优情况就可以了  </p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*************************************************************************</span></div><div class="line">	&gt; File Name: 2.cpp</div><div class="line">	&gt; Author: mazicwong</div><div class="line">	&gt; Mail: mazicwong@gmail.com</div><div class="line">	&gt; Created Time: 2017年07月31日 星期一 22时32分33秒</div><div class="line"> ************************************************************************/</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span>+<span class="number">5</span>;</div><div class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; mp;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">    <span class="keyword">int</span> k;</div><div class="line">    <span class="built_in">string</span> str;</div><div class="line">    <span class="built_in">cin</span> &gt;&gt; k &gt;&gt; str;</div><div class="line">    mp.clear();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</div><div class="line">        mp[i]=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;str.size();i++)</div><div class="line">    &#123;</div><div class="line">        mp[str[i]-<span class="string">'0'</span>]++;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> cnt=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span> (mp[i])</div><div class="line">        &#123;</div><div class="line">            cnt += mp[i]*i;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> ans=<span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span> (cnt &gt;= k)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"0"</span>);</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;</div><div class="line">    cnt = k-cnt;</div><div class="line">    <span class="keyword">while</span>(cnt&gt;<span class="number">0</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span> (mp[i]*(<span class="number">9</span>-i) &gt;= cnt)</div><div class="line">        &#123;</div><div class="line">            ans += (cnt/(<span class="number">9</span>-i));</div><div class="line">            <span class="keyword">if</span> (cnt%(<span class="number">9</span>-i)!=<span class="number">0</span>)</div><div class="line">                ans++;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            cnt -= (mp[i]*(<span class="number">9</span>-i));</div><div class="line">            ans += mp[i];</div><div class="line">        &#125;</div><div class="line">        i++;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="835C-dp二维前缀和-预处理"><a href="#835C-dp二维前缀和-预处理" class="headerlink" title="835C dp二维前缀和+预处理"></a><a href="http://codeforces.com/problemset/problem/835/C" target="_blank" rel="external">835C dp二维前缀和+预处理</a></h2><p>题意:</p>
<blockquote>
<p>给出n个点(100*100的矩阵中),每个点给出坐标和初始权值,<br>给出常数c(1 ≤ c ≤ 10),每一秒钟,所有点的权值会增加1,直到超过c,则变为0<br>q次询问,每次给出时间t和两个点的坐标,<br>问到时间t时,这两个点围成的矩形内所有点的权值和是多少</p>
</blockquote>
<p>思路:</p>
<blockquote>
<p>明显,每个点权值变化的循环节是(c+1),<br>c最大是10,所以可以预处理出所有11种情况(事实上c+1种情况就可以了)<br>所以开一个二维前缀和循环数组,dp[k][i][j]表示第k秒,从[1,1]到[i,j]的权值总和,<br>最后问[x1,y1][x2,y2]就<code>dp[x2][y2]-dp[x2][y1-1]-dp[x1-1][y2]+dp[x1-1][y1-1]</code></p>
</blockquote>
<p>注意:</p>
<blockquote>
<ol>
<li>最后的坐标范围写成10*10了,莫名WA.有点可惜</li>
<li>mp开出来就memset一下..有时候开出来不是初值全0的,又WA了一发..</li>
</ol>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*************************************************************************</span></div><div class="line">	&gt; File Name: 3.cpp</div><div class="line">	&gt; Author: mazicwong</div><div class="line">	&gt; Mail: mazicwong@gmail.com</div><div class="line">	&gt; Created Time: 2017年07月31日 星期一 23时01分34秒</div><div class="line"> ************************************************************************/</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">100</span>+<span class="number">5</span>;</div><div class="line"><span class="keyword">int</span> t,x1,y1,x2,y2;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> mp[<span class="number">11</span>][<span class="number">105</span>][<span class="number">105</span>];</div><div class="line">    freopen(<span class="string">"in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">    <span class="keyword">int</span> n,q,c;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;q,&amp;c);</div><div class="line">    <span class="keyword">int</span> xx,yy,ss;</div><div class="line">    <span class="built_in">memset</span>(mp,<span class="number">0</span>,<span class="keyword">sizeof</span>(mp));</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;xx,&amp;yy,&amp;ss);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;=<span class="number">10</span>;k++)</div><div class="line">        &#123;</div><div class="line">            mp[k][xx][yy] += ((ss+k)%(c+<span class="number">1</span>));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;=<span class="number">10</span>;k++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">100</span>;i++)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=<span class="number">100</span>;j++)</div><div class="line">            &#123;</div><div class="line">                mp[k][i][j] = mp[k][i][j] - mp[k][i<span class="number">-1</span>][j<span class="number">-1</span>] + mp[k][i][j<span class="number">-1</span>] + mp[k][i<span class="number">-1</span>][j];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">while</span>(q--)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> ans=<span class="number">0</span>;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d%d"</span>,&amp;t,&amp;x1,&amp;y1,&amp;x2,&amp;y2);</div><div class="line">        t%=(c+<span class="number">1</span>);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,mp[t][x2][y2]-mp[t][x2][y1<span class="number">-1</span>]-mp[t][x1<span class="number">-1</span>][y2]+mp[t][x1<span class="number">-1</span>][y1<span class="number">-1</span>]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="835D-dp处理字符串"><a href="#835D-dp处理字符串" class="headerlink" title="835D  dp处理字符串"></a><a href="http://codeforces.com/problemset/problem/835/D" target="_blank" rel="external">835D  dp处理字符串</a></h2><p>题意:</p>
<blockquote>
<p>定义k-回文串为:<br>若一个字符串为回文串，则该字符串为1-回文串<br>若一个字符串为回文串，且其左半部分（奇数长度则不包括中间字符）与右半部分均为k-1-回文串，则该串为k-回文串<br>给出一个长度为n的字符串，问这个字符串的子串中有多少个k-回文串(k [1..n]) n&lt;=5000  </p>
</blockquote>
<p>思路:</p>
<blockquote>
<p>设dp[i,j]表示str[i…j]这一段对应的k值是多少。注意到若一个串是k-回文串，则其一定是k-1-回文串<br>str[i,j]是回文串当且仅当str[i+1,j-1]是回文串且str[i]==str[j]  </p>
<blockquote>
<p><strong>状态</strong>: <code>dp[l][r]</code>: maximum k such that substring[l,r] is k-palindrome<br><strong>边界</strong>: <code>dp[l][l]=1 &amp;&amp; dp[l][l+1]=1|0</code><br><strong>转移</strong>: <code>if (str[l]!=str[r] || dp[l+1][r-1]==0) dp[l][r]=0</code><br>      <code>else dp[l][r]=dp[l][m]+1  ( m=(l+r)/2-1 )</code>  </p>
</blockquote>
</blockquote>
<p>注意:</p>
<blockquote>
<p><code>for (int i=n-1;i&gt;=0;i--)</code> 会提示segmentation fault</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*************************************************************************</span></div><div class="line">	&gt; File Name: 4.cpp</div><div class="line">	&gt; Author: mazicwong</div><div class="line">	&gt; Mail: mazicwong@gmail.com</div><div class="line">	&gt; Created Time: 2017年08月01日 星期二 09时36分08秒</div><div class="line"> ************************************************************************/</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e3</span>+<span class="number">5</span>;</div><div class="line"><span class="keyword">int</span> dp[maxn][maxn];<span class="comment">//状态,边界,状态转移</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> cnt[maxn];<span class="comment">//最大到最小,k-palindrome的个数</span></div><div class="line"><span class="keyword">bool</span> vis[maxn][maxn];<span class="comment">//</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">    <span class="keyword">int</span> a;</div><div class="line">    <span class="keyword">char</span> str[maxn];</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>,str+<span class="number">1</span>);</div><div class="line">    <span class="keyword">int</span> n=<span class="built_in">strlen</span>(str+<span class="number">1</span>);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">        vis[i][i]=vis[i][i<span class="number">-1</span>]=<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> len=<span class="number">1</span>;len&lt;n;len++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i+len&lt;=n;i++)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">int</span> j=i+len;</div><div class="line">            <span class="keyword">if</span> (str[i]==str[j] &amp;&amp; vis[i+<span class="number">1</span>][j<span class="number">-1</span>])</div><div class="line">                vis[i][j]=<span class="number">1</span>;</div><div class="line">            <span class="keyword">else</span> vis[i][j]=<span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) dp[i][i]=<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> len=<span class="number">1</span>;len&lt;n;len++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i+len&lt;=n;i++)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">int</span> j=i+len;</div><div class="line">            <span class="keyword">if</span>(vis[i][j])</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">int</span> m = (i+j+<span class="number">1</span>)/<span class="number">2</span><span class="number">-1</span>;</div><div class="line">                dp[i][j] = dp[i][m]+<span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">memset</span>(cnt,<span class="number">0</span>,<span class="keyword">sizeof</span>(cnt));</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=i;j&lt;=n;j++)</div><div class="line">            cnt[dp[i][j]]++;<span class="comment">//最大为k时,每种k对应的个数</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=n;i&gt;=<span class="number">1</span>;i--) cnt[i]+=cnt[i+<span class="number">1</span>];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">        <span class="built_in">printf</span>(i==n?<span class="string">"%d"</span>:<span class="string">"%d "</span>,cnt[i]);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="mazicwong.github.io/2017/08/01/cf427/" data-id="cj6p4z93n0009nescjovrwmwy" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/codeforces/">codeforces</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dp/">dp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/greedy/">greedy</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-cf426" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/07/29/cf426/" class="article-date">
  <time datetime="2017-07-29T12:26:40.000Z" itemprop="datePublished">2017-07-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/07/29/cf426/">cf426</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="codeforces-Round-426-div2"><a href="#codeforces-Round-426-div2" class="headerlink" title="codeforces Round #426 div2"></a>codeforces Round #426 div2</h1><h2 id="A"><a href="#A" class="headerlink" title="A"></a><a href="http://codeforces.com/problemset/problem/834/A" target="_blank" rel="external">A</a></h2><p>题意:</p>
<blockquote>
<p>简单模拟下顺逆转,规律题</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*************************************************************************</span></div><div class="line">	&gt; File Name: a.cpp</div><div class="line">	&gt; Author: mazicwong</div><div class="line">	&gt; Mail: mazicwong@gmail.com</div><div class="line">	&gt; Created Time: 2017年07月30日 星期日 22时36分21秒</div><div class="line"> ************************************************************************/</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="built_in">map</span>&lt;<span class="keyword">char</span>,<span class="keyword">int</span>&gt;mp;</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">    mp[<span class="string">'v'</span>]=<span class="number">0</span>;</div><div class="line">    mp[<span class="string">'&lt;'</span>]=<span class="number">1</span>;</div><div class="line">    mp[<span class="string">'^'</span>]=<span class="number">2</span>;</div><div class="line">    mp[<span class="string">'&gt;'</span>]=<span class="number">3</span>;</div><div class="line">    <span class="keyword">char</span> a,b;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%c%*c%c"</span>,&amp;a,&amp;b);</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">    n%=<span class="number">4</span>;</div><div class="line">    <span class="keyword">int</span> tt = (mp[a]+n)%<span class="number">4</span>;</div><div class="line">    <span class="keyword">int</span> qq = (mp[a]+<span class="number">4</span>-n)%<span class="number">4</span>;</div><div class="line">    <span class="keyword">if</span> (qq==mp[b] &amp;&amp; tt==mp[b])</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"undefined"</span>);</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (tt==mp[b])</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"cw"</span>);</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="built_in">printf</span>(<span class="string">"ccw"</span>);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="B-模拟"><a href="#B-模拟" class="headerlink" title="B 模拟"></a><a href="http://codeforces.com/problemset/problem/834/B" target="_blank" rel="external">B 模拟</a></h2><p>题意:</p>
<blockquote>
<p>给n个打乱的字母,从头开始读取,<br>对每个字母,第一次读取到时放入篮子中,直到最后一次读取到才拿出,<br>要求篮子中的字母个数不能超过k个  </p>
</blockquote>
<p>思路:</p>
<blockquote>
<p>法1. 从前往后扫一遍,标记每个字母第一次出现的位置<br>然后从后往前扫一遍,标记每个字符第一次出现的位置<br>模拟扫描一遍字母,第一次出现cnt++,最后一次出现cnt–,判断该过程是否出现cnt&gt;k的情况<br>WA点-&gt;注意到过程中如果只出现了一次,也应该要加1,判断完再减掉<br>法2. 直接扫一遍,维护两个数组l[26]和r[26],其余的同上,注意好STL的使用(这种更好)</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//顺逆分别扫一遍得到最左最右</span></div><div class="line"><span class="comment">/*************************************************************************</span></div><div class="line">	&gt; File Name: b.cpp</div><div class="line">	&gt; Author: mazicwong</div><div class="line">	&gt; Mail: mazicwong@gmail.com</div><div class="line">	&gt; Created Time: 2017年07月30日 星期日 22时55分27秒</div><div class="line"> ************************************************************************/</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">5</span>;</div><div class="line"><span class="keyword">int</span> n,k;</div><div class="line"><span class="built_in">map</span>&lt;<span class="keyword">char</span>,<span class="keyword">int</span>&gt;mp;</div><div class="line"><span class="built_in">map</span>&lt;<span class="keyword">char</span>,<span class="keyword">int</span>&gt;mpp;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">    mp.clear();</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%*c"</span>,&amp;n,&amp;k);</div><div class="line">    <span class="keyword">char</span> str[maxn];</div><div class="line">    <span class="keyword">int</span> flag[maxn];</div><div class="line">    <span class="built_in">memset</span>(flag,<span class="number">0</span>,<span class="keyword">sizeof</span>(flag));</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>,str);</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span> (!mp[str[i]])</div><div class="line">        &#123;</div><div class="line">            flag[i]++;</div><div class="line">            mp[str[i]]=<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    mp.clear();</div><div class="line">    mpp.clear();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(!mp[str[i]])</div><div class="line">        &#123;</div><div class="line">            flag[i]--;</div><div class="line">            mp[str[i]]=<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        mpp[str[i]]++;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> cnt=<span class="number">0</span>;</div><div class="line">    <span class="keyword">bool</span> mmm=<span class="literal">true</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">    &#123;</div><div class="line">        cnt+=flag[i];</div><div class="line">        <span class="keyword">if</span>(cnt+(mpp[str[i]]==<span class="number">1</span>) &gt; k)</div><div class="line">        &#123;</div><div class="line">            mmm=<span class="literal">false</span>;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (mmm)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"NO"</span>);</div><div class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"YES"</span>);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//只扫一遍维护好l[26]和r[26]</span></div><div class="line"><span class="comment">/*************************************************************************</span></div><div class="line">	&gt; File Name: b1.cpp</div><div class="line">	&gt; Author: mazicwong</div><div class="line">	&gt; Mail: mazicwong@gmail.com</div><div class="line">	&gt; Created Time: 2017年07月31日 星期一 10时31分28秒</div><div class="line"> ************************************************************************/</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">    <span class="keyword">int</span> n,k;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;k);</div><div class="line">    <span class="built_in">string</span> str;</div><div class="line">    <span class="built_in">cin</span> &gt;&gt; str;</div><div class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; sum(n+<span class="number">100</span>,<span class="number">0</span>), l(<span class="number">30</span>,<span class="number">1e9</span>), r(<span class="number">30</span>,<span class="number">-1e9</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;str.size();i++)</div><div class="line">    &#123;</div><div class="line">        l[str[i]-<span class="string">'A'</span>] = min(l[str[i]-<span class="string">'A'</span>], i);</div><div class="line">        r[str[i]-<span class="string">'A'</span>] = max(r[str[i]-<span class="string">'A'</span>], i);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;i++)</div><div class="line">        <span class="keyword">if</span> (l[i]!=<span class="number">1e9</span> &amp;&amp; r[i]!=<span class="number">-1e9</span>)</div><div class="line">            sum[l[i]]++,sum[r[i]+<span class="number">1</span>]--;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;str.size();i++)</div><div class="line">        sum[i]+=sum[i<span class="number">-1</span>];</div><div class="line">    <span class="keyword">int</span> flag = *max_element(sum.begin(), sum.end());</div><div class="line">    <span class="built_in">puts</span>(flag&gt;k? <span class="string">"YES"</span>:<span class="string">"NO"</span>);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="C-立方根"><a href="#C-立方根" class="headerlink" title="C 立方根"></a><a href="http://codeforces.com/problemset/problem/833/A" target="_blank" rel="external">C 立方根</a></h2><p>题意:</p>
<blockquote>
<p>两个人玩游戏,初始分均为1,定义一种操作,<br>给一个数k,每次其中一人的分数乘以k^2,另一个乘以k,进行无限次操作<br>现在给出查询,两个分数,问能否到达该种状态</p>
</blockquote>
<p>思路:</p>
<blockquote>
<p>因为一个是k^2,一个是k,所以很明显他们的乘积会是k^3,<br>所以可以将这两个分数相乘看下立方根是否为整数,<br>若为整数,且该立方根同时是两个分数的公约数,则可以实现<br>(因为该立方根都是由每个分数的因子组成的,要避免有1,64这种情况)</p>
</blockquote>
<p>注意:</p>
<blockquote>
<p>这题求立方根的时候,用pow(a<em>b,1.0/3)可能会出现精度问题,<br>网上已经有很多讨论过pow会丢失很大精度的文章了,可以尝试pow(a</em>b,1.0/3 + 1e-7)这种<br>看到有人代码是直接用cbrt(a<em>b),也会丢失精度<br>还有一种可能就是二分直接搜有没有该立方根,复杂度会比pow好一些,<br>然后也可以直接预处理出1e18以内的立方根,用`mp[i</em>i*i]=i`存下来  </p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//二分找立方根</span></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(ll a, ll b)</span></span></div><div class="line">&#123;</div><div class="line">    ll l = <span class="number">1</span>, r = MAX;</div><div class="line"></div><div class="line">    ll cmp = a * b;</div><div class="line">    <span class="keyword">while</span> (l &lt;= r)</div><div class="line">    &#123;</div><div class="line">        ll mid = (l+r)/<span class="number">2</span>;</div><div class="line">        <span class="keyword">if</span>(mid * mid * mid &lt; cmp)</div><div class="line">        &#123;</div><div class="line">            l = mid + <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> r = mid - <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(l * l * l == cmp &amp;&amp; !(a % l) &amp;&amp; !(b % l)) <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//直接预处理出答案</span></div><div class="line"><span class="comment">/*************************************************************************</span></div><div class="line">	&gt; File Name: c.cpp</div><div class="line">	&gt; Author: mazicwong</div><div class="line">	&gt; Mail: mazicwong@gmail.com</div><div class="line">	&gt; Created Time: 2017年07月30日 星期日 23时30分13秒</div><div class="line"> ************************************************************************/</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">350000</span>+<span class="number">5</span>;</div><div class="line"><span class="built_in">map</span>&lt;ll,<span class="keyword">int</span>&gt;mp;</div><div class="line">ll a,b;</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">for</span>(ll i=<span class="number">0</span>;i&lt;ll(<span class="number">1e6</span>)+<span class="number">5</span>;i++)</div><div class="line">        mp[i*i*i]=i;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">    init();</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">    <span class="keyword">while</span>(n--)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;a,&amp;b);</div><div class="line">        ll tt = a*b;</div><div class="line">        <span class="keyword">if</span> (mp.count(tt) &amp;&amp; a%mp[a*b]==<span class="number">0</span> &amp;&amp; b%mp[a*b]==<span class="number">0</span>)</div><div class="line">            <span class="built_in">puts</span>(<span class="string">"Yes"</span>);</div><div class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"No"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="D-dp-线段树优化"><a href="#D-dp-线段树优化" class="headerlink" title="D dp + 线段树优化"></a><a href="http://codeforces.com/problemset/problem/833/B" target="_blank" rel="external">D dp + 线段树优化</a></h2><p>题意:</p>
<blockquote>
<p>给n个蛋糕,每种蛋糕用一个数字表示,可以重复,<br>要将这n个蛋糕分成k段,使得每一段中蛋糕种类数的和最多</p>
</blockquote>
<p>思路:</p>
<blockquote>
<p>明显是dp问题,看成后面那一块要不要独立成段的问题,但是要用数据结构优化复杂度<br>dp[k][n],前n个数切成k段的最大和<br>ls[i],记录i处蛋糕种类前一次出现的位置<br>线段树每个点记录:dp[i-1][x-1]+val[x]<br>val[x]是从x到当前位置j这段中蛋糕种类数</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*************************************************************************</span></div><div class="line">	&gt; File Name: d.cpp</div><div class="line">	&gt; Author: mazicwong</div><div class="line">	&gt; Mail: mazicwong@gmail.com</div><div class="line">	&gt; Created Time: 2017年07月31日 星期一 00时47分39秒</div><div class="line"> ************************************************************************/</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">35000</span>+<span class="number">5</span>;</div><div class="line"><span class="comment">/*</span></div><div class="line"> * 线段树每个位置x记录的是dp[i-1][x-1]+val[x]</div><div class="line"> * val[x]表示从位置x到当前枚举的位置j这段中不同种类的数的个数</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">int</span> dp[<span class="number">55</span>][maxn]; <span class="comment">//dp[i][j]: 前j个分成i部分的最大和</span></div><div class="line"><span class="keyword">int</span> ls[maxn];</div><div class="line"><span class="keyword">int</span> last[maxn];</div><div class="line"></div><div class="line"><span class="keyword">int</span> n,k;</div><div class="line"><span class="keyword">int</span> arr[maxn];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">L</span><span class="params">(<span class="keyword">int</span> l)</span></span>&#123;<span class="keyword">return</span> l&lt;&lt;<span class="number">1</span>;&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">R</span><span class="params">(<span class="keyword">int</span> r)</span></span>&#123;<span class="keyword">return</span> (r&lt;&lt;<span class="number">1</span>)+<span class="number">1</span>;&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">MID</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;<span class="keyword">return</span> (l+r)&gt;&gt;<span class="number">1</span>;&#125;</div><div class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> mx; <span class="comment">//dp[i-1][x-1]+val[x] (前x-1分成i-1段,从x到j是一段)</span></div><div class="line">    <span class="keyword">int</span> lazy;</div><div class="line">&#125;node;</div><div class="line">node t[maxn*<span class="number">5</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> root)</span></span></div><div class="line">&#123;</div><div class="line">    t[root].mx=max(t[L(root)].mx, t[R(root)].mx);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> root,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (t[root].lazy)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> tmp = t[root].lazy;</div><div class="line">        t[L(root)].mx += tmp;</div><div class="line">        t[R(root)].mx += tmp;</div><div class="line">        t[L(root)].lazy += tmp;</div><div class="line">        t[R(root)].lazy += tmp;</div><div class="line">        t[root].lazy=<span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> d,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> now)</span></span></div><div class="line">&#123;</div><div class="line">    t[d].lazy=<span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span> (l==r)</div><div class="line">    &#123;</div><div class="line">        t[d].mx=dp[now][l<span class="number">-1</span>];<span class="comment">//建树时初值用dp[i-1][x],后面insert再加上val[x]</span></div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> mid=MID(l,r);</div><div class="line">    build(L(d),l,mid,now);</div><div class="line">    build(R(d),mid+<span class="number">1</span>,r,now);</div><div class="line">    pushup(d);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> d,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (x&gt;y) <span class="keyword">return</span>;</div><div class="line">    pushdown(d,l,r);</div><div class="line">    <span class="keyword">if</span> (l==x &amp;&amp; r==y)</div><div class="line">    &#123;</div><div class="line">        t[d].mx+=z; <span class="comment">//更新时加上val[x]  (x到j距离)</span></div><div class="line">        t[d].lazy+=z;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> mid=MID(l,r);</div><div class="line">    insert(L(d),l,mid,x,min(y,mid),z);</div><div class="line">    insert(R(d),mid+<span class="number">1</span>,r,max(x,mid+<span class="number">1</span>),y,z);</div><div class="line">    pushup(d);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> d,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span></div><div class="line">&#123;<span class="comment">//查询前缀最大</span></div><div class="line">    <span class="keyword">if</span>(x&gt;y) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    pushdown(d,l,r);</div><div class="line">    <span class="keyword">if</span>(l==x &amp;&amp; r==y) <span class="keyword">return</span> t[d].mx;</div><div class="line">    <span class="keyword">int</span> mid=MID(l,r);</div><div class="line">    <span class="keyword">return</span> max(query(L(d),l,mid,x,min(y,mid)), query(R(d),mid+<span class="number">1</span>,r,max(x,mid+<span class="number">1</span>),y));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;k);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;arr[i]);</div><div class="line">        ls[i]=last[arr[i]];<span class="comment">//ls: 上一次出现arr[i]的位置</span></div><div class="line">        last[arr[i]]=i;<span class="comment">//last: arr[i]最后一次出现的地方</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=k;i++)</div><div class="line">    &#123;</div><div class="line">        build(<span class="number">1</span>,<span class="number">1</span>,n,i<span class="number">-1</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++) <span class="comment">//前j个数分成i段</span></div><div class="line">        &#123;</div><div class="line">            insert(<span class="number">1</span>,<span class="number">1</span>,n,ls[j]+<span class="number">1</span>,j,<span class="number">1</span>);<span class="comment">//更新ls[j]+1到j的mx</span></div><div class="line">            dp[i][j]=query(<span class="number">1</span>,<span class="number">1</span>,n,<span class="number">1</span>,j);<span class="comment">//查询1~j的前缀和的mx</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,dp[k][n]);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="mazicwong.github.io/2017/07/29/cf426/" data-id="cj6p4z93l0006nescjyq703hf" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cbrt/">cbrt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/codeforces/">codeforces</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dp/">dp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/segment-tree/">segment_tree</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-cf425" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/07/25/cf425/" class="article-date">
  <time datetime="2017-07-25T03:52:23.000Z" itemprop="datePublished">2017-07-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/07/25/cf425/">cf425</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="codeforces-Round-425-div2"><a href="#codeforces-Round-425-div2" class="headerlink" title="codeforces Round #425 div2"></a>codeforces Round #425 div2</h1><h3 id="codeforces-832A"><a href="#codeforces-832A" class="headerlink" title="codeforces 832A"></a><a href="http://codeforces.com/problemset/problem/832/A" target="_blank" rel="external">codeforces 832A</a></h3><p>A.给n和k,两人轮流拿,每次拿k个,先拿不了k个的人输,问先手能不能赢<br>简单的相除<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*************************************************************************</span></div><div class="line">	&gt; File Name: A.cpp</div><div class="line">	&gt; Author: mazicwong</div><div class="line">	&gt; Mail: mazicwong@gmail.com</div><div class="line">	&gt; Created Time: 2017年07月24日 星期一 22时24分05秒</div><div class="line"> ************************************************************************/</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line">ll n,k;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="comment">//freopen("in","r",stdin);</span></div><div class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</div><div class="line">    ll tmp = n/k;</div><div class="line">    <span class="keyword">if</span> (tmp%<span class="number">2</span>==<span class="number">1</span>)</div><div class="line">        <span class="built_in">puts</span>(<span class="string">"YES"</span>);</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="built_in">puts</span>(<span class="string">"NO"</span>);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="codeforces-832B"><a href="#codeforces-832B" class="headerlink" title="codeforces 832B"></a><a href="http://codeforces.com/problemset/problem/832/B" target="_blank" rel="external">codeforces 832B</a></h3><p>B.<br>题意:</p>
<blockquote>
<p>给一个字符串,再给一个包含<em>和?的模式串,<br>(</em>至多一个,表示匹配一串字符,其中的字母不能出现在第一个字符串中;<br>?匹配一个出现在第一个字符串里的字母)<br>然后n个查询,每个查询是一个串,问能否用之前的模式串来匹配他</p>
</blockquote>
<p>思路:</p>
<blockquote>
<p>没有<em>的时候,直接匹配;有</em>的时候,分成三段,<em>之前和</em>之后的两段分别匹配,<em>代表的那段单独拿出来匹配;<br>思路不难,实现起来代码好难写..试了一早上<br>/</em> WA12是前缀<em>,可以代表空串 </em>/</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*************************************************************************</span></div><div class="line">	&gt; File Name: B.cpp</div><div class="line">	&gt; Author: mazicwong</div><div class="line">	&gt; Mail: mazicwong@gmail.com</div><div class="line">	&gt; Created Time: 2017年07月24日 星期一 22时41分27秒</div><div class="line"> ************************************************************************/</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span>+<span class="number">5</span>;</div><div class="line"></div><div class="line"><span class="built_in">map</span>&lt;<span class="keyword">char</span>,<span class="keyword">int</span>&gt; mp;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">    <span class="keyword">char</span> str[maxn];</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    mp.clear();</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>,str);</div><div class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(str);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)</div><div class="line">    &#123;</div><div class="line">        mp[str[i]]=<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">char</span> match[maxn];</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>,match);</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">    <span class="keyword">int</span> len_m = <span class="built_in">strlen</span>(match);</div><div class="line">    <span class="keyword">int</span> numb,nume;</div><div class="line">    <span class="keyword">bool</span> is_star=<span class="literal">false</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len_m;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(match[i]==<span class="string">'*'</span>)</div><div class="line">        &#123;</div><div class="line">            is_star=<span class="literal">true</span>;</div><div class="line">            numb=i;</div><div class="line">            nume=len_m-numb<span class="number">-1</span>;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;n;k++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">bool</span> flag=<span class="literal">true</span>;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>,str);</div><div class="line">        <span class="keyword">int</span> len_s = <span class="built_in">strlen</span>(str);</div><div class="line">        <span class="keyword">if</span>(is_star==<span class="literal">true</span>)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(len_m<span class="number">-1</span>&gt;len_s)</div><div class="line">            &#123;</div><div class="line">                flag=<span class="literal">false</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(flag)</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;numb;i++)</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">if</span>(match[i]==<span class="string">'?'</span>)</div><div class="line">                &#123;</div><div class="line">                    <span class="keyword">if</span>(mp[str[i]]!=<span class="number">1</span>)</div><div class="line">                    &#123;</div><div class="line">                        flag=<span class="literal">false</span>;</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">else</span></div><div class="line">                &#123;</div><div class="line">                    <span class="keyword">if</span>(str[i]!=match[i])</div><div class="line">                    &#123;</div><div class="line">                        flag=<span class="literal">false</span>;</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(flag)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=numb+<span class="number">1</span>;i&lt;len_m;i++)</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">if</span>(match[i]==<span class="string">'?'</span>)</div><div class="line">                &#123;</div><div class="line">                    <span class="keyword">if</span>(mp[str[i+(len_s-nume-numb<span class="number">-1</span>)]]!=<span class="number">1</span>)</div><div class="line">                    &#123;</div><div class="line">                        flag=<span class="literal">false</span>;</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">else</span></div><div class="line">                &#123;</div><div class="line">                    <span class="keyword">if</span>(str[i+(len_s-nume-numb<span class="number">-1</span>)]!=match[i])</div><div class="line">                    &#123;<span class="comment">//...</span></div><div class="line">                        flag=<span class="literal">false</span>;</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(flag)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=numb;i&lt;len_s-nume;i++)</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">if</span>(mp[str[i]]==<span class="number">1</span>)</div><div class="line">                &#123;</div><div class="line">                    flag=<span class="literal">false</span>;</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(len_m!=len_s)</div><div class="line">            &#123;</div><div class="line">                flag=<span class="number">0</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span></div><div class="line">            &#123;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len_s;i++)</div><div class="line">                &#123;</div><div class="line">                    <span class="keyword">if</span>(match[i]==<span class="string">'?'</span>)</div><div class="line">                    &#123;</div><div class="line">                        <span class="keyword">if</span>(mp[str[i]]==<span class="number">0</span>)</div><div class="line">                        &#123;</div><div class="line">                            flag=<span class="literal">false</span>;</div><div class="line">                            <span class="keyword">break</span>;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">else</span></div><div class="line">                    &#123;</div><div class="line">                        <span class="keyword">if</span>(str[i]!=match[i])</div><div class="line">                        &#123;</div><div class="line">                            flag=<span class="literal">false</span>;</div><div class="line">                            <span class="keyword">break</span>;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (flag) <span class="built_in">puts</span>(<span class="string">"YES"</span>);</div><div class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"NO"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="codeforces-832D-lca-rmq在线st"><a href="#codeforces-832D-lca-rmq在线st" class="headerlink" title="codeforces 832D lca+rmq在线st"></a><a href="http://codeforces.com/problemset/problem/832/D" target="_blank" rel="external">codeforces 832D lca+rmq在线st</a></h3><h2 id="题意"><a href="#题意" class="headerlink" title="题意:"></a>题意:</h2><blockquote>
<p>给一棵树，和三个点，问其中两个点到第三个点的公共路径长度的最大值是多少  </p>
</blockquote>
<p>##思路:</p>
<blockquote>
<p>三个点两两求一下LCA，肯定会有两个LCA相同。然后再分一下情况求距离即可  </p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*************************************************************************</span></div><div class="line">	&gt; File Name: 832D.cpp</div><div class="line">	&gt; Author: mazicwong</div><div class="line">	&gt; Mail: mazicwong@gmail.com</div><div class="line">	&gt; Created Time: 2017年07月30日 星期日 22时19分46秒</div><div class="line"> ************************************************************************/</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span>+<span class="number">5</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> to,next;</div><div class="line">&#125;e[maxn&lt;&lt;<span class="number">1</span>];</div><div class="line"></div><div class="line"><span class="keyword">int</span> head[maxn];</div><div class="line"><span class="keyword">int</span> tot=<span class="number">0</span>;<span class="comment">//点数</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">    e[tot].to=v;</div><div class="line">    e[tot].next=head[u];</div><div class="line">    head[u]=tot++;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//que[]:欧拉序列,即dfs遍历的顺序</span></div><div class="line"><span class="keyword">int</span> que[maxn&lt;&lt;<span class="number">1</span>];<span class="comment">//第i次dfs访问节点的编号[1..2n-1]  (vs[i])</span></div><div class="line"><span class="keyword">int</span> dep[maxn&lt;&lt;<span class="number">1</span>];<span class="comment">//第i次dfs访问节点的深度  </span></div><div class="line"><span class="keyword">int</span> fir[maxn];<span class="comment">//在que数组中i节点首次出现的下标 (id[i])</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> p[maxn&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> st[maxn&lt;&lt;<span class="number">1</span>][<span class="number">20</span>];<span class="comment">//rmq用来存的,st[i][j]从i开始的2^j个数</span></div><div class="line"><span class="keyword">int</span> vis[maxn&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> cnt=<span class="number">0</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> d)</span></span></div><div class="line">&#123;</div><div class="line">    vis[u]=<span class="number">1</span>;</div><div class="line">    que[++cnt]=u;fir[u]=cnt;dep[cnt]=d;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k=head[u];k!=<span class="number">-1</span>;k=e[k].next)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> v=e[k].to;</div><div class="line">        <span class="keyword">if</span> (!vis[v])</div><div class="line">        &#123;</div><div class="line">            p[v]=u;</div><div class="line">            dfs(v,d+<span class="number">1</span>);</div><div class="line">            que[++cnt]=u;dep[cnt]=d;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">ST</span><span class="params">(<span class="keyword">int</span> n)</span></span></div><div class="line">&#123;<span class="comment">//ST函数,预处理st[i,j],从i开始2^j个数的最小值</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">        st[i][<span class="number">0</span>]=i;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;(<span class="number">1</span>&lt;&lt;j)&lt;=n;j++)</div><div class="line">	&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i+(<span class="number">1</span>&lt;&lt;j)<span class="number">-1</span>&lt;=n;i++)</div><div class="line">		&#123;</div><div class="line">            <span class="keyword">int</span> a=st[i][j<span class="number">-1</span>],b=st[i+(<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>))][j<span class="number">-1</span>];</div><div class="line">            st[i][j]=dep[a]&lt;dep[b]?a:b;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">RMQ</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></div><div class="line">&#123;<span class="comment">//传入两个点在que[]中首次出现位置,然后返回最小值在que[]中位置</span></div><div class="line"><span class="comment">//RMQ函数,计算[l,r]中dep[]最小的</span></div><div class="line">    <span class="keyword">int</span> k=<span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>((<span class="number">1</span>&lt;&lt;(k+<span class="number">1</span>))&lt;=r-l+<span class="number">1</span>)</div><div class="line">	&#123;</div><div class="line">        k++;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> a=st[l][k],b=st[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k];</div><div class="line">    <span class="keyword">return</span> dep[a]&lt;dep[b]?a:b;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span></div><div class="line">&#123;<span class="comment">//直接找两者中最近祖先</span></div><div class="line">    <span class="keyword">int</span> x=fir[u],y=fir[v];</div><div class="line">    <span class="keyword">if</span>(x&gt;y) swap(x,y);</div><div class="line">    <span class="keyword">int</span> ans=RMQ(x,y);</div><div class="line">    <span class="keyword">return</span> que[ans];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/********************************/</span></div><div class="line"><span class="comment">/*struct path&#123;</span></div><div class="line">	int u,v;</div><div class="line">	int lca;</div><div class="line">&#125;pa[maxn];</div><div class="line"></div><div class="line">int cmp(path x,path y)</div><div class="line">&#123;</div><div class="line">    return dep[fir[x.lca]]&gt;dep[fir[y.lca]];</div><div class="line">&#125;</div><div class="line">int used[maxn];*/</div><div class="line"><span class="comment">/********************************************/</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    tot=<span class="number">0</span>;</div><div class="line">    cnt=<span class="number">0</span>;</div><div class="line">    p[<span class="number">1</span>]=<span class="number">0</span>;</div><div class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</div><div class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</div><div class="line">    <span class="comment">//memset(used,0,sizeof(used));</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">depth</span><span class="params">(<span class="keyword">int</span> u)</span></span></div><div class="line">&#123;<span class="comment">//从叶子往上的深度(负数),方便计算</span></div><div class="line">    <span class="keyword">return</span> -dep[fir[u]];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> L[<span class="number">3</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">    <span class="keyword">int</span> n,q;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;q);</div><div class="line">    init();</div><div class="line">    <span class="keyword">int</span> u;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;u);</div><div class="line">        add(i,u);</div><div class="line">        add(u,i);</div><div class="line">    &#125;</div><div class="line">    dfs(<span class="number">1</span>,<span class="number">1</span>);</div><div class="line">    ST(<span class="number">2</span>*n<span class="number">-1</span>);</div><div class="line"></div><div class="line">    <span class="keyword">int</span> a,b,c;</div><div class="line">    <span class="keyword">while</span>(q--)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> ans=<span class="number">0</span>;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;c);</div><div class="line">        L[<span class="number">0</span>]=lca(a,b);</div><div class="line">        L[<span class="number">1</span>]=lca(a,c);</div><div class="line">        L[<span class="number">2</span>]=lca(b,c);</div><div class="line">        <span class="keyword">if</span> (L[<span class="number">0</span>]==L[<span class="number">1</span>] &amp;&amp; L[<span class="number">0</span>]==L[<span class="number">2</span>])</div><div class="line">        &#123;<span class="comment">//三个lca都一样</span></div><div class="line">            ans=max(ans,depth(L[<span class="number">0</span>])-depth(a));</div><div class="line">            ans=max(ans,depth(L[<span class="number">0</span>])-depth(b));</div><div class="line">            ans=max(ans,depth(L[<span class="number">0</span>])-depth(c));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//把L[2]换成非最上面的lca,L[0]变成最上面的lca</span></div><div class="line">            <span class="keyword">if</span> (L[<span class="number">1</span>]==L[<span class="number">2</span>])<span class="comment">//ac,bc</span></div><div class="line">            &#123;</div><div class="line">                swap(a,c);</div><div class="line">                swap(L[<span class="number">0</span>],L[<span class="number">2</span>]);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (L[<span class="number">0</span>]==L[<span class="number">2</span>])<span class="comment">//ab,bc</span></div><div class="line">            &#123;</div><div class="line">                swap(a,b);</div><div class="line">                swap(L[<span class="number">1</span>],L[<span class="number">2</span>]);</div><div class="line">            &#125;</div><div class="line">            ans = max(ans,<span class="number">2</span>*depth(L[<span class="number">0</span>]) - depth(a) - depth(L[<span class="number">2</span>]));</div><div class="line"></div><div class="line">            <span class="keyword">if</span>(L[<span class="number">2</span>]==b)</div><div class="line">            &#123;</div><div class="line">                ans=max(ans,depth(b)-depth(c));  </div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(L[<span class="number">2</span>]==c)</div><div class="line">            &#123;</div><div class="line">                ans=max(ans,depth(c)-depth(b));  </div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span>  </div><div class="line">                ans=max(ans,max(depth(L[<span class="number">2</span>])-depth(b),depth(L[<span class="number">2</span>])-depth(c)));  </div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans+<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="mazicwong.github.io/2017/07/25/cf425/" data-id="cj6p4z93q000anescm5k8y93u" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/codeforces/">codeforces</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Day2-最短路" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/07/23/Day2-最短路/" class="article-date">
  <time datetime="2017-07-23T03:26:38.000Z" itemprop="datePublished">2017-07-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/07/23/Day2-最短路/">Day2-最短路</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="kuangbin专题4-最短路"><a href="#kuangbin专题4-最短路" class="headerlink" title="kuangbin专题4:最短路"></a><a href="https://vjudge.net/contest/66569" target="_blank" rel="external">kuangbin专题4:最短路</a></h1><h2 id="分类"><a href="#分类" class="headerlink" title="分类:"></a>分类:</h2><ul>
<li>poj 2387 dijkstra 裸题(bfs)</li>
<li>poj 2253 dijkstra 最短路径上的最大边<code>dist[]</code></li>
<li>poj 1797 dijkstra 路径上边的最小值最打</li>
<li>poj 3268 dijkstra 两次单源最短路</li>
<li>poj 1502 dijkstra 源点到其他所有点的最短路中的最大</li>
</ul>
<ul>
<li>poj 1860 spfa 找是否存在正环(跟负环区别就是松弛那里变成放大策略)</li>
<li>poj 3259 spfa 判负环(单向图,邻接表)</li>
<li>poj 2240 spfa 找是否存在正环</li>
<li>poj 1511 spfa 两次单源最短路</li>
</ul>
<ul>
<li>poj 3660 floyd 求传递闭包(多少个点跟其他所有点均有优先级)</li>
<li>hdu 1704 floyd 求传递闭包(多少个匹配不存在优先级&amp;TLE后优化)</li>
<li>poj 2240 floyd 找正环(求所有最短路,找是否有<code>dist[i][i]&gt;1</code> )<h2 id="升级"><a href="#升级" class="headerlink" title="升级"></a>升级</h2><em>可以努力读懂别人的经典模板，不要去试图读懂别人的代码，那样会越来越乱<br>每道题有独特的地方，如果不懂可以按照博客思路然后自己用板子实现，特别是最短路问题</em><h2 id="debug遇过的问题"><a href="#debug遇过的问题" class="headerlink" title="debug遇过的问题"></a>debug遇过的问题</h2></li>
</ul>
<ol>
<li>看下标1开始还是0开始</li>
<li>写最短路忘了调用函数</li>
<li>vec.que.mp没清空</li>
<li>函数定义为double distance()会莫名其妙产生bug</li>
<li>poj 1511,一个数据量很大的最短路,开了个全局的dist[1e6][1e6],然后g++一直过不了..还是经验太少了,以后得注意内存太大记得放栈空间(但是也有可能core dumped = =!)</li>
</ol>
<hr>
<h1 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h1><h5 id="各个单源最短路径算法的区别在于：对每条边松弛操作的次数，以及松弛的次序"><a href="#各个单源最短路径算法的区别在于：对每条边松弛操作的次数，以及松弛的次序" class="headerlink" title="各个单源最短路径算法的区别在于：对每条边松弛操作的次数，以及松弛的次序"></a>各个单源最短路径算法的区别在于：对每条边松弛操作的次数，以及松弛的次序</h5><h5 id="松弛操作：就是更新两点间的最短路径。"><a href="#松弛操作：就是更新两点间的最短路径。" class="headerlink" title="松弛操作：就是更新两点间的最短路径。"></a>松弛操作：就是更新两点间的最短路径。</h5><ul>
<li><p><strong>dijkstra 单源最短路径 O(n^2)</strong></p>
<blockquote>
<p>从源点起设为集合S，每次从外面取最短长度的点进行两个操作(松弛+加入S)，直到S包含所有点，则dist[]记录了从源点到其他顶点的最短距离</p>
</blockquote>
</li>
<li><p><strong>spfa 队列优化的Bellman</strong></p>
<blockquote>
<p>初始化将所有边设为INF，然后将源点入队，每次取队首进行两个操作(松弛+入队)，直到队列空<br><a href="http://www.360doc.com/content/13/1208/22/14357424_335569176.shtml" target="_blank" rel="external">参考博客</a></p>
<blockquote>
<p><strong>判断有无负环:</strong> 某个点入队超n次，则存在负环<br><strong>和bfs区别:</strong> bfs只能入队一次,spfa可以多次入队<br><strong>注意加边的时候是单向的还是双向的</strong> eg poj1259  </p>
</blockquote>
</blockquote>
</li>
<li><p><strong>floyd 求所有点对最短距离(代码比dijkstra简单)(传递闭包)</strong></p>
<blockquote>
<p>对k循环,然后两重循环所有点对,用dp讨论所有点对经过k点和不经过k点的情况</p>
</blockquote>
</li>
</ul>
<p>1.最短路</p>
<p>1.1 dijkstra 单元最短路(邻接矩阵)<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line"> * 单源最短路径,Dijkstra算法,邻接矩阵形式,复杂度为O(n^2)</div><div class="line"> * 求出源beg到所有点的最短路径,传入图的顶点数,和邻接矩阵cost[][]</div><div class="line"> * 返回各点的最短路径dist[], 路径pre[].pre[i]记录beg到i路径上的父结点,pre[beg]=-1</div><div class="line"> * 可更改路径权类型,但是权值必须为非负</div><div class="line"> */</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1010</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF=<span class="number">0x3f3f3f3f</span>;<span class="comment">//防止后面溢出,这个不能太大</span></div><div class="line"><span class="keyword">bool</span> vis[maxn];</div><div class="line"><span class="keyword">int</span> pre[maxn];<span class="comment">//存储路径</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Dijkstra</span><span class="params">(<span class="keyword">int</span> cost[][maxn],<span class="keyword">int</span> dist[],<span class="keyword">int</span> n,<span class="keyword">int</span> beg)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">    &#123;</div><div class="line">        dist[i]=INF;</div><div class="line">        vis[i]=<span class="literal">false</span>;</div><div class="line">        pre[i]=<span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">    dist[beg]=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;j++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> k=<span class="number">-1</span>;</div><div class="line">        <span class="keyword">int</span> minn=INF;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)<span class="comment">//找最小距离</span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(!vis[i] &amp;&amp; dist[i]&lt;minn)</div><div class="line">            &#123;</div><div class="line">                minn=dist[i];</div><div class="line">                k=i;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(k==<span class="number">-1</span>)<span class="keyword">break</span>;</div><div class="line">        vis[k]=<span class="literal">true</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)<span class="comment">//松弛</span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(!vis[i] &amp;&amp; dist[k]+cost[k][i]&lt;dist[i])</div><div class="line">            &#123;</div><div class="line">                dist[i] = dist[k]+cost[k][i];</div><div class="line">                pre[i] = k;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>1.2 dijkstra+堆优化(邻接表)<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line">使用优先队列优化,复杂度O(E logE)</div><div class="line"><span class="comment">/*</span></div><div class="line"> * 使用优先队列优化Dijkstra算法</div><div class="line"> * 复杂度O(ElogE)</div><div class="line"> * 注意对vector&lt;Edge&gt;E[maxn] 进行初始化后加边</div><div class="line"> */</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF=<span class="number">0x3f3f3f3f</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1000010</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">qnode</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> v;</div><div class="line">    <span class="keyword">int</span> c;</div><div class="line">    qnode(<span class="keyword">int</span> _v=<span class="number">0</span>,<span class="keyword">int</span> _c=<span class="number">0</span>):v(_v),c(_c)&#123;&#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> qnode &amp;r)<span class="keyword">const</span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> c&gt;r.c;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> v,cost;</div><div class="line">    Edge(<span class="keyword">int</span> _v=<span class="number">0</span>,<span class="keyword">int</span> _cost=<span class="number">0</span>):v(_v),cost(_cost)&#123;&#125;</div><div class="line">&#125;;</div><div class="line"><span class="built_in">vector</span>&lt;Edge&gt; E[maxn];</div><div class="line"><span class="keyword">bool</span> vis[maxn];</div><div class="line"><span class="keyword">int</span> dist[maxn];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Dijkstra</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> beg)</span><span class="comment">//点的编号从1开始</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span>(vis));</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)dist[i]=INF;</div><div class="line">    priority_queue&lt;qnode&gt; que;</div><div class="line">    <span class="keyword">while</span>(!que.empty())que.pop();</div><div class="line">    dist[beg]=<span class="number">0</span>;</div><div class="line">    que.push(qnode(beg,<span class="number">0</span>));</div><div class="line">    qnode tmp;</div><div class="line">    <span class="keyword">while</span>(!que.empty())</div><div class="line">    &#123;</div><div class="line">        tmp=que.top();</div><div class="line">        que.pop();</div><div class="line">        <span class="keyword">int</span> u=tmp.v;</div><div class="line">        <span class="keyword">if</span>(vis[u])<span class="keyword">continue</span>;</div><div class="line">        vis[u]=<span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;E[u].size();i++)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">int</span> v=E[tmp.v][i].v;</div><div class="line">            <span class="keyword">int</span> cost=E[u][i].cost;</div><div class="line">            <span class="keyword">if</span>(!vis[v]&amp;&amp;dist[v]&gt;dist[u]+cost)</div><div class="line">            &#123;</div><div class="line">                dist[v]=dist[u]+cost;</div><div class="line">                que.push(qnode(v,dist[v]));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span></span></div><div class="line">&#123;</div><div class="line">    E[u].push_back(Edge(v,w));</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>1.4 单源最短路 spfa(邻接表存图,队列实现)<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line"> * 单源最短路SPFA</div><div class="line"> * 时间复杂度 0(kE)</div><div class="line"> * 这个是队列实现,有时候改成栈实现会更加快,很容易修改</div><div class="line"> * 这个复杂度是不定的</div><div class="line"> * 只有v和cost的边是为了配合vector,采用数组实现邻接表存图</div><div class="line"> */</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1010</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF=<span class="number">0x3f3f3f3f</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> v;</div><div class="line">    <span class="keyword">int</span> cost;</div><div class="line">    Edge(<span class="keyword">int</span> _v=<span class="number">0</span>,<span class="keyword">int</span> _cost=<span class="number">0</span>):v(_v),cost(_cost)&#123;&#125;</div><div class="line">&#125;;</div><div class="line"><span class="built_in">vector</span>&lt;Edge&gt; E[maxn];<span class="comment">//数组实现邻接表存储</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span></span></div><div class="line">&#123;</div><div class="line">    E[u].push_back(Edge(v,w));</div><div class="line">&#125;</div><div class="line"><span class="keyword">bool</span> vis[maxn];<span class="comment">//在队列标志</span></div><div class="line"><span class="keyword">int</span> dist[maxn];<span class="comment">//源点到每个点的最短距离</span></div><div class="line"><span class="keyword">int</span> cnt[maxn];<span class="comment">//每个点的入队列次数</span></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">SPFA</span><span class="params">(<span class="keyword">int</span> start,<span class="keyword">int</span> n)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> a,next;<span class="comment">//1 对int队列处理的暂存值</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;i++)</div><div class="line">    &#123;</div><div class="line">        vis[i]=<span class="literal">false</span>;</div><div class="line">        dist[i]=INF;</div><div class="line">        cnt[i]=<span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    vis[start]=<span class="literal">true</span>;<span class="comment">//3 更新3个</span></div><div class="line">    dist[start]=<span class="number">0</span>;</div><div class="line">    cnt[start]=<span class="number">1</span>;</div><div class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;<span class="comment">//4</span></div><div class="line">    <span class="keyword">while</span>(!que.empty())que.pop();</div><div class="line">    que.push(start);<span class="comment">//5 入队(经典五步)</span></div><div class="line">    <span class="keyword">while</span>(!que.empty())</div><div class="line">    &#123;</div><div class="line">        a=que.front();<span class="comment">//取队首,a是取出来那个点，习惯用a跟next了../用u跟v也可以</span></div><div class="line">        que.pop();</div><div class="line">        vis[a]=<span class="literal">false</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;E[a].size();i++) <span class="comment">//对该点的所有边"松弛+入队"</span></div><div class="line">        &#123;</div><div class="line">            next=E[a][i].v;</div><div class="line">            <span class="keyword">if</span>(dist[next]&gt;dist[a]+E[a][i].cost)</div><div class="line">            &#123;</div><div class="line">                dist[next]=dist[a]+E[a][i].cost; <span class="comment">//下一个点不够松，则松弛下一个点</span></div><div class="line">                <span class="keyword">if</span>(!vis[next]) <span class="comment">//下一个点未入队，则入队下一个点</span></div><div class="line">                &#123;</div><div class="line">                    vis[next]=<span class="literal">true</span>;</div><div class="line">                    que.push(next);</div><div class="line">                    <span class="keyword">if</span>(++cnt[next]&gt;n)<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">                    <span class="comment">//判断负环:某个点入队超n次，则存在负环，cnt[i]为入队列次数</span></div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="comment">//记得清空栈</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n+<span class="number">1</span>;i++) E[i].clear();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>1.5 任意两点间最短路 floyd<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* </span></div><div class="line"> * 传递闭包的时候有个优化</div><div class="line"> * 先判断win[i][k]存在,否则就不进行循环</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">floyd</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;n;k++)</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;j++)</div><div class="line">                <span class="comment">/* 最短路</span></div><div class="line">                 * dist[i][j] = min(dist[i][j], dist[i][k]+dist[k][j]);</div><div class="line">                 */</div><div class="line"></div><div class="line">                <span class="comment">/* 传递闭包</span></div><div class="line">                 * if (win[i][k]&amp;&amp;win[k][j]) //直接按定义</div><div class="line">                 *     win[i][j] = 1;</div><div class="line">                 */</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><h2 id="poj-2387-dijkstra裸题-bfs"><a href="#poj-2387-dijkstra裸题-bfs" class="headerlink" title="poj 2387 dijkstra裸题(bfs)"></a>poj 2387 dijkstra裸题(bfs)</h2><h3 id="题意"><a href="#题意" class="headerlink" title="题意:"></a>题意:</h3><blockquote>
<p>从n点走到1点,给出边和权重,求最短路</p>
</blockquote>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路:"></a>思路:</h3><blockquote>
<p><code>vector&lt;node&gt; G[maxn]</code> 存图(十字链表)<br><code>node{int to; int cost;};</code><br><code>priority_queue&lt;P, vector&lt;P&gt;,greater&lt;P&gt; &gt; que;</code> 存点</p>
</blockquote>
<hr>
<h2 id="poj-2253-dijkstra-完全图-所以存图直接用struct然后遍历所有点就行了"><a href="#poj-2253-dijkstra-完全图-所以存图直接用struct然后遍历所有点就行了" class="headerlink" title="poj 2253 dijkstra(完全图,所以存图直接用struct然后遍历所有点就行了)"></a>poj 2253 dijkstra(完全图,所以存图直接用struct然后遍历所有点就行了)</h2><h3 id="题意-1"><a href="#题意-1" class="headerlink" title="题意:"></a>题意:</h3><blockquote>
<p>从源点到终点存在多条路径，每一条路径中有一个最大的两点间距离，求这些最大距离中的最小值</p>
</blockquote>
<h3 id="思路-dijkstra-floyd-spfa都可以，只是将松弛条件-更新条件-改变一下"><a href="#思路-dijkstra-floyd-spfa都可以，只是将松弛条件-更新条件-改变一下" class="headerlink" title="思路:dijkstra,floyd,spfa都可以，只是将松弛条件(更新条件)改变一下"></a>思路:dijkstra,floyd,spfa都可以，只是将松弛条件(更新条件)改变一下</h3><blockquote>
<p>这里用dijkstra,则dist数组不能存i到源点的最短距离了，要定义为：i到源点最短路径上的最大边<br>则在</p>
</blockquote>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意:"></a>注意:</h3><blockquote>
<p>发现函数名定义为<code>double distance()</code>会莫名其妙产生bug..(required from here),改一下名字就好了</p>
</blockquote>
<hr>
<h2 id="poj-1797-dijkstra变形"><a href="#poj-1797-dijkstra变形" class="headerlink" title="poj 1797 dijkstra变形"></a>poj 1797 dijkstra变形</h2><h3 id="题意-2"><a href="#题意-2" class="headerlink" title="题意:"></a>题意:</h3><blockquote>
<p>源点到终点的流量是路径上边的最小值，要另这个最小值最大<br>找到一个最短路，求该路径上最小边的权</p>
</blockquote>
<h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路:"></a>思路:</h3><blockquote>
<p>dist[i]是从源点到i点中的最小边权.<br>不断从未访问的点中选出dist[i]最大的点cnt，然后更新其他dist[i]的值<br><code>dist[i] = min(dist[cnt], cost[cnt][i]);</code></p>
</blockquote>
<h3 id="注意-这道题用cin过不了…尴尬"><a href="#注意-这道题用cin过不了…尴尬" class="headerlink" title="注意:这道题用cin过不了…尴尬"></a>注意:这道题用cin过不了…尴尬</h3><blockquote>
<p>也可以用下面这个<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt;<span class="built_in">cin</span>.tie(<span class="number">0</span>);</div><div class="line">&gt;ios::sync_with_stdio(<span class="literal">false</span>);</div><div class="line">&gt;</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h2 id="poj-3268-dijkstra-有向图-两次单源最短路"><a href="#poj-3268-dijkstra-有向图-两次单源最短路" class="headerlink" title="poj 3268 dijkstra(有向图,两次单源最短路)"></a>poj 3268 dijkstra(有向图,两次单源最短路)</h2><h3 id="题意-3"><a href="#题意-3" class="headerlink" title="题意:"></a>题意:</h3><blockquote>
<p>很多只牛在不同的点，要去到同一个点然后返回，每个都是最短路，问这些最短路中的最大是多少</p>
</blockquote>
<h3 id="思路-2"><a href="#思路-2" class="headerlink" title="思路:"></a>思路:</h3><blockquote>
<p>返回的话，把终点看成源点，求一遍dist[]就得到了，<br>因为是有向图，去的话有点难，把所有方向反过来，然后继续对终点求一次单源最短路就可以了<br><code>dist[i] = min(dist[cnt], cost[cnt][i]);</code></p>
</blockquote>
<hr>
<h2 id="poj-1502-dijkstra找最短路"><a href="#poj-1502-dijkstra找最短路" class="headerlink" title="poj 1502 dijkstra找最短路"></a>poj 1502 dijkstra找最短路</h2><h3 id="题意-4"><a href="#题意-4" class="headerlink" title="题意:"></a>题意:</h3><blockquote>
<p>n个点,双向图,给一个下三角矩阵,表明边权,</p>
</blockquote>
<h3 id="思路-3"><a href="#思路-3" class="headerlink" title="思路:"></a>思路:</h3><blockquote>
<p>dijkstra求源点到其他所有点最短路,因为是并行处理,所以找出其中的最大</p>
</blockquote>
<hr>
<h2 id="poj-1860-spfa"><a href="#poj-1860-spfa" class="headerlink" title="poj 1860 spfa"></a>poj 1860 spfa</h2><h3 id="题意-5"><a href="#题意-5" class="headerlink" title="题意:"></a>题意:</h3><blockquote>
<p>货币交换,给出各种汇率,题目有点长.不过不难</p>
</blockquote>
<h3 id="思路-4"><a href="#思路-4" class="headerlink" title="思路:"></a>思路:</h3><blockquote>
<p>只需要寻找一下是否有正环存在就可以了,若某类钱币入队大于n次就存在正环</p>
</blockquote>
<hr>
<h2 id="poj-3259-spfa判负环-单向图-邻接表"><a href="#poj-3259-spfa判负环-单向图-邻接表" class="headerlink" title="poj 3259 spfa判负环,单向图,邻接表"></a>poj 3259 spfa判负环,单向图,邻接表</h2><p>题意:</p>
<blockquote>
<p>n个点,m条正边,w条负边,问有没有负环</p>
</blockquote>
<p>思路:</p>
<blockquote>
<p>显然判负环用SPFA就行啦,cnt[i]&gt;n时存在负环</p>
</blockquote>
<p>注意:</p>
<blockquote>
<p>虽然简单,还有有几个点要注意,一个是读题,这题是正边双向,负边单向,一开始没注意到<br>还有一个是多次输入记得清空栈和队列</p>
</blockquote>
<hr>
<h2 id="poj-3660-floyd求传递闭包"><a href="#poj-3660-floyd求传递闭包" class="headerlink" title="poj 3660 floyd求传递闭包"></a>poj 3660 floyd求传递闭包</h2><h3 id="题意-6"><a href="#题意-6" class="headerlink" title="题意:"></a>题意:</h3><blockquote>
<p>给出n个点,m对相对关系,求有多少个点的排名是确定的</p>
</blockquote>
<h3 id="思路-5"><a href="#思路-5" class="headerlink" title="思路:"></a>思路:</h3><blockquote>
<p>floyd求传递闭包,要某个点排名确定,即该点和其他所有点的先序关系均确定</p>
</blockquote>
<hr>
<h2 id="hdu-1704-floyd求传递闭包"><a href="#hdu-1704-floyd求传递闭包" class="headerlink" title="hdu 1704 floyd求传递闭包"></a>hdu 1704 floyd求传递闭包</h2><h3 id="题意-7"><a href="#题意-7" class="headerlink" title="题意:"></a>题意:</h3><blockquote>
<p>给n点,m优先级,问多少个匹配不存在优先级</p>
</blockquote>
<h3 id="思路-6"><a href="#思路-6" class="headerlink" title="思路:"></a>思路:</h3><blockquote>
<p>floyd求传递闭包得出所有点对间的优先级,然后判下多少个匹配不存在优先级就可以了</p>
</blockquote>
<h3 id="注意-1"><a href="#注意-1" class="headerlink" title="注意:"></a>注意:</h3><blockquote>
<p>一开始直接搞TLE了,然后做了个小优化</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">floyd__</span><span class="params">()</span><span class="comment">//优化前</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=n;k++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">if</span> (win[i][k] &amp;&amp; win[k][j])</div><div class="line">                    win[i][j] = <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">floyd</span><span class="params">()</span> <span class="comment">//优化后</span></span></div><div class="line">&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=n;k++)</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">                <span class="keyword">if</span> (win[i][k])</div><div class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</div><div class="line">                        <span class="keyword">if</span> (win[k][j])</div><div class="line">                            win[i][j] = <span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="poj-2240-spfa-amp-floyd-求正环"><a href="#poj-2240-spfa-amp-floyd-求正环" class="headerlink" title="poj 2240 spfa&amp;floyd 求正环"></a>poj 2240 spfa&amp;floyd 求正环</h2><h3 id="题意-8"><a href="#题意-8" class="headerlink" title="题意:"></a>题意:</h3><blockquote>
<p>给n种货币,m个货币转换率,问能否发财!(存在正环哈哈)  </p>
</blockquote>
<h3 id="思路-判正环"><a href="#思路-判正环" class="headerlink" title="思路:判正环"></a>思路:判正环</h3><blockquote>
<p>用map解决点是string的问题<br>spfa: 对所有点进行一次spfa()..正环的话,改变一下松弛策略,变成放大策略就行<br><code>dist[next] = max(dist[next], dist[a]*E[a][i].cost)</code><br>floyd: 求出所有最短路,然后判断有没有大于1的dist[i][i]</p>
</blockquote>
<h3 id="注意-2"><a href="#注意-2" class="headerlink" title="注意:"></a>注意:</h3><blockquote>
<p>这题找错找了很久,以后记得1.看下标 2.忘了调用函数 3.vec,que,mp没清空- -!</p>
</blockquote>
<ul>
<li><p>spfa</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*************************************************************************</span></div><div class="line">	&gt; File Name: poj2240.cpp</div><div class="line">	&gt; Author: mazicwong</div><div class="line">	&gt; Mail: mazicwong@gmail.com</div><div class="line">	&gt; Created Time: 2017年07月22日 星期六 16时33分42秒</div><div class="line"> ************************************************************************/</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">30</span>+<span class="number">5</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> v;</div><div class="line">    <span class="keyword">double</span> cost;</div><div class="line">    Edge(<span class="keyword">int</span> _v=<span class="number">0</span>,<span class="keyword">double</span> _cost=<span class="number">0</span>):v(_v),cost(_cost)&#123;&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">double</span> dist[maxn];</div><div class="line"><span class="built_in">string</span> str;</div><div class="line"><span class="built_in">vector</span>&lt;Edge&gt; E[maxn];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">double</span> w)</span></span></div><div class="line">&#123;</div><div class="line">    E[u].push_back(Edge(v,w));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">bool</span> vis[maxn];</div><div class="line"><span class="keyword">int</span> cnt[maxn];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> start,<span class="keyword">int</span> n)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> a,next;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;i++)</div><div class="line">    &#123;</div><div class="line">        vis[i]=<span class="literal">false</span>;</div><div class="line">        dist[i]=<span class="number">0</span>;</div><div class="line">        cnt[i]=<span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    vis[start]=<span class="literal">true</span>;</div><div class="line">    dist[start]=<span class="number">1</span>;</div><div class="line">    cnt[start]=<span class="number">1</span>;</div><div class="line"></div><div class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;</div><div class="line">    que.push(start);</div><div class="line">    <span class="keyword">while</span>(!que.empty())</div><div class="line">    &#123;</div><div class="line">        a = que.front();</div><div class="line">        que.pop();</div><div class="line">        vis[a]=<span class="literal">false</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;E[a].size();i++)</div><div class="line">        &#123;</div><div class="line">            next=E[a][i].v;</div><div class="line">            <span class="keyword">if</span> (dist[next] &lt; dist[a]*E[a][i].cost)<span class="comment">//松弛</span></div><div class="line">            &#123;</div><div class="line">                dist[next] = dist[a]*E[a][i].cost;</div><div class="line">                <span class="keyword">if</span>(!vis[next])<span class="comment">//入队</span></div><div class="line">                &#123;</div><div class="line">                    vis[next]=<span class="literal">true</span>;</div><div class="line">                    que.push(next);</div><div class="line">                    <span class="keyword">if</span>(++cnt[next] &gt; n)</div><div class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">map</span>&lt;<span class="built_in">string</span>,<span class="keyword">int</span>&gt; mp;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">    <span class="keyword">int</span> n,m;</div><div class="line">    <span class="keyword">int</span> cas=<span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n) &amp;&amp; n)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n+<span class="number">1</span>;i++)</div><div class="line">            E[i].clear();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">cin</span> &gt;&gt; str;</div><div class="line">            mp[str]=i;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</div><div class="line">        <span class="built_in">string</span> str1,str2;</div><div class="line">        <span class="keyword">double</span> aa;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;i++)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">cin</span> &gt;&gt; str1 &gt;&gt; aa &gt;&gt; str2;</div><div class="line">            <span class="keyword">int</span> a = mp[str1];</div><div class="line">            <span class="keyword">int</span> b = mp[str2];</div><div class="line">            addedge(a,b,aa);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">bool</span> flag = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(spfa(i,n))</div><div class="line">            &#123;</div><div class="line">                flag=<span class="number">1</span>;<span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (flag)</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"Case %d: Yes\n"</span>,cas++);</div><div class="line">        <span class="keyword">else</span></div><div class="line">            <span class="built_in">printf</span>(<span class="string">"Case %d: No\n"</span>,cas++);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>floyd</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*************************************************************************</span></div><div class="line">	&gt; File Name: poj2240.cpp</div><div class="line">	&gt; Author: mazicwong</div><div class="line">	&gt; Mail: mazicwong@gmail.com</div><div class="line">	&gt; Created Time: 2017年07月22日 星期六 19时46分45秒</div><div class="line"> ************************************************************************/</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">30</span>+<span class="number">5</span>;</div><div class="line"><span class="keyword">double</span> dist[maxn][maxn];</div><div class="line"><span class="keyword">int</span> cnt[maxn];</div><div class="line"><span class="keyword">bool</span> vis[maxn];</div><div class="line"></div><div class="line"><span class="built_in">map</span>&lt;<span class="built_in">string</span>,<span class="keyword">int</span>&gt;mp;</div><div class="line"><span class="keyword">int</span> n,m;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">floyd</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=n;k++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</div><div class="line">            &#123;</div><div class="line">                dist[i][j]=max(dist[i][j], dist[i][k]*dist[k][j]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">    <span class="built_in">string</span> str;</div><div class="line">    <span class="keyword">int</span> cas=<span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n) &amp;&amp; n)</div><div class="line">    &#123;</div><div class="line">        mp.clear();</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">cin</span> &gt;&gt; str;</div><div class="line">            mp[str]=i;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">if</span>(i==j) dist[i][j]=<span class="number">1</span>;</div><div class="line">                <span class="keyword">else</span> dist[i][j]=<span class="number">0</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</div><div class="line">        <span class="built_in">string</span> str1,str2;</div><div class="line">        <span class="keyword">double</span> tmp;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;i++)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">cin</span> &gt;&gt; str1 &gt;&gt; tmp &gt;&gt; str2;</div><div class="line">            <span class="keyword">int</span> a = mp[str1];</div><div class="line">            <span class="keyword">int</span> b = mp[str2];</div><div class="line">            dist[a][b]=tmp;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">bool</span> flag = <span class="number">0</span>;</div><div class="line">        floyd();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span> (dist[i][i]&gt;<span class="number">1</span>)</div><div class="line">            &#123;</div><div class="line">                flag = <span class="literal">true</span>;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (flag)</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"Case %d: Yes\n"</span>,cas++);</div><div class="line">        <span class="keyword">else</span></div><div class="line">            <span class="built_in">printf</span>(<span class="string">"Case %d: No\n"</span>,cas++);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<h2 id="poj-1511-spfa求原图和逆图的最短路"><a href="#poj-1511-spfa求原图和逆图的最短路" class="headerlink" title="poj 1511 spfa求原图和逆图的最短路"></a>poj 1511 spfa求原图和逆图的最短路</h2><h3 id="题意-9"><a href="#题意-9" class="headerlink" title="题意:"></a>题意:</h3><blockquote>
<p>读了好久的题..就是一个强连通图,给n个点,和m条单向边,求源点1到其他每个点来回的最短路之和</p>
</blockquote>
<h3 id="思路-7"><a href="#思路-7" class="headerlink" title="思路:"></a>思路:</h3><blockquote>
<p>spfa求原图和逆图的最短路</p>
</blockquote>
<h3 id="巨坑点"><a href="#巨坑点" class="headerlink" title="巨坑点:"></a>巨坑点:</h3><blockquote>
<p>数据量很大,开了个dist[1e6][1e6],g++报错了<br>改过来后..Segmentation fault(core dumped)</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="mazicwong.github.io/2017/07/23/Day2-最短路/" data-id="cj6p4z93b0002nescqlvt54ra" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kuangbin/">kuangbin</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shortestPath/">shortestPath</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-调试" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/07/22/调试/" class="article-date">
  <time datetime="2017-07-22T13:24:41.000Z" itemprop="datePublished">2017-07-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/07/22/调试/">调试</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol>
<li><p>gdb</p>
<blockquote>
<p>file a.out<br>r run<br>c continue<br>b breakpoint<br>s,n step_into/step_over<br>p print (p i)<br>display<br>q quit</p>
</blockquote>
</li>
<li><p>输出调试 cout</p>
</li>
</ol>
<ol>
<li>输出调试高级版<blockquote>
<p>开头  <code>#define D(x) x</code><br>然后调试语句用  <code>D(调试语句)</code><br>最后要提交的时候将定义改为  <code>#define D(x)</code></p>
</blockquote>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="mazicwong.github.io/2017/07/22/调试/" data-id="cj6p4z94t0017nescq5t3fdp9" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/">&laquo; __('prev')</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/FFT/">FFT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LCA/">LCA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RMQ/">RMQ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/big-data/">big data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cbrt/">cbrt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/codeforces/">codeforces</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dfs/">dfs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dp/">dp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/greedy/">greedy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/homework/">homework</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kuangbin/">kuangbin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/plan/">plan</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/search/">search</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/segment-tree/">segment_tree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shortestPath/">shortestPath</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/区间/">区间</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/尺取法/">尺取法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/常用技巧/">常用技巧</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/搜索/">搜索</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/树/">树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/树形DP/">树形DP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模板/">模板</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/百度之星/">百度之星</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/邻接表/">邻接表</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/FFT/" style="font-size: 10px;">FFT</a> <a href="/tags/LCA/" style="font-size: 10px;">LCA</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/RMQ/" style="font-size: 10px;">RMQ</a> <a href="/tags/big-data/" style="font-size: 10px;">big data</a> <a href="/tags/cbrt/" style="font-size: 10px;">cbrt</a> <a href="/tags/codeforces/" style="font-size: 20px;">codeforces</a> <a href="/tags/dfs/" style="font-size: 10px;">dfs</a> <a href="/tags/dp/" style="font-size: 15px;">dp</a> <a href="/tags/greedy/" style="font-size: 10px;">greedy</a> <a href="/tags/homework/" style="font-size: 10px;">homework</a> <a href="/tags/kuangbin/" style="font-size: 15px;">kuangbin</a> <a href="/tags/plan/" style="font-size: 10px;">plan</a> <a href="/tags/search/" style="font-size: 10px;">search</a> <a href="/tags/segment-tree/" style="font-size: 10px;">segment_tree</a> <a href="/tags/shortestPath/" style="font-size: 10px;">shortestPath</a> <a href="/tags/区间/" style="font-size: 10px;">区间</a> <a href="/tags/尺取法/" style="font-size: 10px;">尺取法</a> <a href="/tags/常用技巧/" style="font-size: 10px;">常用技巧</a> <a href="/tags/搜索/" style="font-size: 10px;">搜索</a> <a href="/tags/树/" style="font-size: 10px;">树</a> <a href="/tags/树形DP/" style="font-size: 10px;">树形DP</a> <a href="/tags/模板/" style="font-size: 10px;">模板</a> <a href="/tags/百度之星/" style="font-size: 10px;">百度之星</a> <a href="/tags/邻接表/" style="font-size: 10px;">邻接表</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/08/23/强连通分量/">强连通分量</a>
          </li>
        
          <li>
            <a href="/2017/08/19/cf429/">cf429</a>
          </li>
        
          <li>
            <a href="/2017/08/17/对拍程序/">对拍程序</a>
          </li>
        
          <li>
            <a href="/2017/08/17/各种数学/">各种数学</a>
          </li>
        
          <li>
            <a href="/2017/08/17/博弈论/">博弈论</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 MazicWong<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>